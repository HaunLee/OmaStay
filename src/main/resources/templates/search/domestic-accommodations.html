<!DOCTYPE html>
<html lang="ko" layout:decorate="~{layout/search_main}"
      layout:fragment="search"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/></head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider/dist/nouislider.min.css">
    <link rel="stylesheet" href="/css/component/slider.css">

<body>
<div
        class="w-full relative bg-[#fff] overflow-y-auto flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[100px] box-border leading-[normal] tracking-[normal]"
>
    <main
            class="self-stretch flex flex-row items-start justify-center py-[0px] px-[20px] box-border max-w-full"
    >
        <section
                class="w-[1200px] flex flex-row items-start justify-start pt-[16px] px-[0px] pb-[0px] box-border max-w-[1200px] text-left text-[15.1px] text-[#333] font-[Inter] lg:max-w-full mq1050:h-auto"
        >
            <div
                    class="flex-1 flex flex-row items-start justify-start gap-[16px] max-w-full shrink-0"
            >
                <div
                        class="w-[288px] flex flex-col items-start justify-start pt-[36px] px-[0px] pb-[0px] box-border mq1050:hidden"
                >
                    <div class="self-stretch flex flex-col items-start justify-start">
                        <div
                                class="self-stretch flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[20px]"
                        >
                            <div
                                    class="flex-1 rounded-[12px] overflow-hidden flex flex-row items-start justify-start py-[66.4px] px-[80px] bg-[url('/image/domestic-accommodations/map@3x.png')] bg-cover bg-no-repeat bg-[top] mq450:pl-[20px] mq450:pr-[20px] mq450:box-border"
                            >
                                <button class="btn btn-primary w-32 h-[42px] flex flex-row items-center justify-center font-semibold text-[13.1px]  font-[Inter] text-[#fff] text-center"
                                        onclick="showmap()"
                                >
                                    지도 보기
                                </button>
                            </div>
                        </div>
                        <div id="main-filter" th:insert="~{component/search/searchfilter :: filterbar('main')}"></div>
                    </div>
                </div>
                <div
                        class="flex-1 flex flex-col items-start justify-start pt-[0px] pb-[104px] pl-[16px] pr-[0px] box-border max-w-[calc(100%_-_304px)] text-[10.3px] text-[#707070] lg:pb-[29px] lg:box-border mq750:pb-[20px] mq750:box-border mq1050:max-w-full"
                >
                    <div
                            class="self-stretch bg-[#fff] flex flex-row items-center justify-between pt-[16px] px-[0px] pb-[20px] box-border min-h-[80px] [row-gap:20px] max-w-full gap-[0px] text-[22.9px] text-[#333] mq1050:flex-wrap"
                    >
                        <div
                                class="w-[732px] flex flex-col items-start justify-start py-[0px] pl-[0px] pr-[16px] box-border max-w-full"
                        >
                            <div
                                    class="self-stretch overflow-hidden flex flex-row items-start justify-start py-[0px] pl-[0px] pr-[534px] [row-gap:20px] mq450:pr-[20px] mq450:box-border mq750:flex-wrap mq750:pr-[267px] mq750:box-border"
                            >
                                <h3
                                        class="m-[0px] w-[9px] relative text-[24px] font-bold font-[inherit] flex items-center mq450:text-[19px] mq750:w-full mq750:h-[9px]"
                                >
                                    '
                                </h3>
                                <div
                                        class="overflow-hidden flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[2px] text-[22.5px]"
                                >
                                    <a
                                            class="[text-decoration:none] relative font-bold text-[inherit] inline-block min-w-[45px] mq450:text-[18px]"
                                    >강릉</a
                                    >
                                </div>
                                <b
                                        class="relative inline-block min-w-[8px] mq450:text-[18px] mq750:w-full mq750:h-[8px]"
                                >'</b
                                >
                                <a
                                        class="[text-decoration:none] relative font-bold text-[inherit] inline-block min-w-[120px] mq450:text-[18px]"
                                >
                                    숙소 660개</a
                                >
                            </div>
                        </div>
                        <div
                                class="flex flex-col items-start justify-start text-[15px]"
                        >

                                <div id="dropdown-filter"
                                        class="dropdown pr-[9px] min-w-[41.48px]"
                                >
                                    <button id="dropdown-filter-button"
                                            class="btn btn-light dropdown-toggle w-[100%]"
                                            type="button" data-bs-toggle="dropdown" aria-expanded="false" value="rating">
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li value="rating"><p class="dropdown-item">평점높은순</p></li>
                                        <li value="review"><p class="dropdown-item">리뷰많은순</p></li>
                                        <li value="lowprice"><p class="dropdown-item">낮은가격순</p></li>
                                        <li value="highprice"><p class="dropdown-item">높은가격순</p></li>
                                    </ul>
                                </div>
                        </div>
                    </div>
                    <div
                            class="self-stretch bg-[#fff] border-[#ebebeb] border-b-[1px] border-solid box-border flex flex-col items-start justify-start pt-[20px] px-[0px] pb-[19px] max-w-full cursor-pointer"
                            id="cardWrapperContainer">
                        <div
                                class="self-stretch flex flex-row items-start justify-start [row-gap:20px] max-w-full mq750:flex-wrap"
                        >
                            <div
                                    class="h-[240px] w-[396px] flex flex-col items-start justify-center min-w-[396px] max-w-full mq750:flex-1 mq750:min-w-full"
                            >
                                <img
                                        alt=""
                                        class="self-stretch flex-1 relative rounded-[12px] max-w-full overflow-hidden max-h-full object-cover mq750:self-stretch mq750:w-auto"
                                        loading="lazy"
                                        src="/image/domestic-accommodations/uvjpvw9k8yjwjpg@2x.png"
                                />
                            </div>
                            <div
                                    class="flex-1 overflow-hidden flex flex-col items-start justify-between py-[0px] pl-[20px] pr-[0px] box-border min-w-[315px] min-h-[240px] max-w-full mq750:min-h-[auto]"
                            >
                                <div
                                        class="self-stretch flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[4px]"
                                >
                                    <div
                                            class="self-stretch flex flex-col items-start justify-start gap-[4px]"
                                    >
                                        <div
                                                class="self-stretch flex flex-col items-start justify-start gap-[2px]"
                                        >
                                            <div
                                                    class="self-stretch flex flex-row items-center justify-start"
                                            >
                                                <div
                                                        class="flex flex-row items-center justify-start"
                                                >
                                                    <div
                                                            class="relative font-semibold inline-block min-w-[21px]"
                                                    >
                                                        펜션
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                    class="self-stretch flex flex-col items-start justify-start text-[16.9px] text-[#333]"
                                            >
                                                <b class="self-stretch relative"
                                                >강릉 라임비치 스파 펜션</b
                                                >
                                            </div>
                                        </div>
                                        <div
                                                class="self-stretch flex flex-row items-center justify-start py-[0px] pl-[0px] pr-[361px] [row-gap:20px] text-[11.6px] text-[#333] mq450:pr-[180px] mq450:box-border mq750:flex-wrap"
                                        >
                                            <div
                                                    class="flex flex-col items-start justify-start py-[0px] pl-[0px] pr-[6px]"
                                            >
                                                <div
                                                        class="rounded-[6px] bg-[#ffad0a] flex flex-row items-center justify-center pt-[4px] pb-[3px] pl-[3px] pr-[5px]"
                                                >
                                                    <div
                                                            class="flex flex-col items-start justify-start pt-[0px] pb-[2px] pl-[0px] pr-[2px]"
                                                    >
                                                        <div
                                                                class="overflow-hidden flex flex-col items-center justify-center"
                                                        >
                                                            <img
                                                                    alt=""
                                                                    class="w-[12px] h-[12px] relative"
                                                                    src="/image/domestic-accommodations/frame.svg"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div
                                                            class="flex flex-col items-start justify-start"
                                                    >
                                                        <b class="relative inline-block min-w-[19px]"
                                                        >9.2</b
                                                        >
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                    class="flex flex-col items-start justify-start text-[12.3px] text-[#707070] mq450:ml-[0px]"
                                            >
                                                <div
                                                        class="relative font-medium inline-block min-w-[56px]"
                                                >
                                                    54명 평가
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="self-stretch flex flex-col items-start justify-start pt-[8px] pb-[0px] pl-[12px] pr-[0px] text-right text-[12.2px] text-[#999]"
                                >
                                    <div
                                            class="self-stretch flex flex-col items-end justify-start"
                                    >
                                        <div class="flex flex-col items-start justify-start">
                                            <div class="flex flex-col items-end justify-start">
                                                <div
                                                        class="relative font-medium inline-block min-w-[74px] whitespace-nowrap"
                                                >
                                                    다른 날짜 확인
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div
                            class="self-stretch bg-[#fff] border-[#ebebeb] border-b-[1px] border-solid box-border flex flex-col items-start justify-start pt-[20px] px-[0px] pb-[19px] max-w-full cursor-pointer"
                            id="linkContainer"
                    >
                        <div
                                class="self-stretch flex flex-row items-start justify-start [row-gap:20px] max-w-full mq750:flex-wrap"
                        >
                            <div
                                    class="h-[240px] w-[396px] flex flex-col items-start justify-center relative min-w-[396px] max-w-full mq750:flex-1 mq750:min-w-full"
                            >
                                <img
                                        alt=""
                                        class="self-stretch flex-1 relative max-w-full overflow-hidden max-h-full object-cover mq750:self-stretch mq750:w-auto"
                                        loading="lazy"
                                        src="/image/domestic-accommodations/container@2x.png"
                                />

                                <div
                                        class="w-[8.08%] h-[35px] !m-[0] absolute top-[14px] right-[88.38%] left-[3.54%] "
                                ></div>
                            </div>
                            <div
                                    class="flex-1 overflow-hidden flex flex-col items-start justify-start py-[0px] pl-[20px] pr-[0px] box-border gap-[123px] min-w-[315px] max-w-full mq750:gap-[61px]"
                            >
                                <div
                                        class="self-stretch flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[4px]"
                                >
                                    <div
                                            class="self-stretch flex flex-col items-start justify-start gap-[4px]"
                                    >
                                        <div
                                                class="self-stretch flex flex-col items-start justify-start gap-[2px]"
                                        >
                                            <div
                                                    class="self-stretch flex flex-row items-center justify-start"
                                            >
                                                <div
                                                        class="flex flex-row items-center justify-start"
                                                >
                                                    <div
                                                            class="relative font-semibold inline-block min-w-[21px]"
                                                    >
                                                        펜션
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                    class="self-stretch flex flex-col items-start justify-start text-[17.3px] text-[#333]"
                                            >
                                                <b class="self-stretch relative">강릉 here365</b>
                                            </div>
                                        </div>
                                        <div
                                                class="self-stretch flex flex-row items-center justify-start py-[0px] pl-[0px] pr-[359px] text-[11.6px] text-[#333] mq450:pr-[179px] mq450:box-border mq750:flex-wrap"
                                        >
                                            <div
                                                    class="flex flex-col items-start justify-start py-[0px] pl-[0px] pr-[6px]"
                                            >
                                                <div
                                                        class="rounded-[6px] bg-[#ffad0a] flex flex-row items-center justify-center pt-[4px] pb-[3px] pl-[3px] pr-[5px]"
                                                >
                                                    <div
                                                            class="flex flex-col items-start justify-start pt-[0px] pb-[2px] pl-[0px] pr-[2px]"
                                                    >
                                                        <div
                                                                class="overflow-hidden flex flex-col items-center justify-center"
                                                        >
                                                            <img
                                                                    alt=""
                                                                    class="w-[12px] h-[12px] relative"
                                                                    src="/image/domestic-accommodations/frame.svg"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div
                                                            class="flex flex-col items-start justify-start"
                                                    >
                                                        <b class="relative inline-block min-w-[19px]"
                                                        >9.8</b
                                                        >
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                    class="flex flex-col items-start justify-start text-[12.3px] text-[#707070]"
                                            >
                                                <div
                                                        class="relative font-medium inline-block min-w-[58px]"
                                                >
                                                    112명 평가
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="self-stretch flex flex-col items-start justify-start pt-[8px] pb-[0px] pl-[12px] pr-[0px] text-[19.2px] text-[#333]"
                                >
                                    <div
                                            class="self-stretch flex flex-col items-end justify-start"
                                    >
                                        <div class="flex flex-row items-center justify-start">
                                            <div class="flex flex-col items-start justify-start">
                                                <b class="relative inline-block min-w-[80px]"
                                                >104,500</b
                                                >
                                            </div>
                                            <div
                                                    class="flex flex-col items-start justify-start pt-[2px] px-[0px] pb-[1px] text-[16px]"
                                            >
                                                <b class="relative inline-block min-w-[15px]">원</b>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div
                            class="self-stretch flex flex-row items-start justify-center pt-[40px] px-[20px] pb-[0px] text-center text-[12px] text-[#000]"
                    >
                        <div class="flex flex-col items-start justify-start">
                            <div class="flex flex-row items-center justify-center">
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] pl-[0px] pr-[4px]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] flex flex-row items-center justify-center p-[8px] box-border"
                                    >
                                        <img
                                                alt=""
                                                class="h-[16px] w-[16px] relative"
                                                src="/image/domestic-accommodations/svg-2.svg"
                                        />
                                    </div>
                                </div>
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] px-[4px]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] flex flex-row items-center justify-center py-[8.5px] px-[12px] box-border"
                                    >
                                        <div
                                                class="relative font-semibold inline-block min-w-[8px]"
                                        >
                                            6
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] px-[4px]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] flex flex-row items-center justify-center py-[8.5px] px-[12px] box-border"
                                    >
                                        <div
                                                class="w-[8px] relative font-semibold flex items-center justify-center min-w-[8px]"
                                        >
                                            7
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] px-[4px]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] flex flex-row items-center justify-center py-[8.5px] px-[12px] box-border"
                                    >
                                        <div
                                                class="relative font-semibold inline-block min-w-[8px]"
                                        >
                                            8
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] px-[4px]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] flex flex-row items-center justify-center py-[8.5px] px-[12px] box-border"
                                    >
                                        <div
                                                class="relative font-semibold inline-block min-w-[8px]"
                                        >
                                            9
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] px-[4px] text-[11.6px] text-[#fff]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] bg-[#1273e4] flex flex-row items-center justify-center p-[9px] box-border"
                                    >
                                        <div
                                                class="w-[14px] relative font-semibold flex items-center justify-center min-w-[14px]"
                                        >
                                            10
                                        </div>
                                    </div>
                                </div>
                                <div
                                        class="flex flex-col items-start justify-start py-[0px] pl-[4px] pr-[0px]"
                                >
                                    <div
                                            class="w-[32px] h-[32px] rounded-[500px] flex flex-row items-center justify-center p-[8px] box-border"
                                    >
                                        <img
                                                alt=""
                                                class="h-[16px] w-[16px] relative"
                                                src="/image/domestic-accommodations/svg-3.svg"
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>
<div class="h-full w-full fixed top-0 left-0 items-center justify-center bg-gray-800 bg-opacity-50 hidden"
     id="modal-wrap">
    <div class="bg-white w-[90%] h-[90%]" id="modal"  th:include="~{/search/modal :: search_modal}"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/nouislider/dist/nouislider.min.js"></script>
<script
        src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=NzqUDqweAh8UqE9Z07ze639x6Wlbcgya9sqhnjXH"></script>

<script>
    // 필터 버튼 값 변경
    $(document).ready(function () {
        $("#dropdown-filter-button").text("평점높은순");
        $("#dropdown-filter-button").val("rating");
        initializeSlider('main');  // 메인 슬라이더 초기화
        console.log($("#dropdown-filter-button").val());
    });

    // 슬라이더 초기화 함수
    function initializeSlider(identifier) {
        var sliderElement = document.getElementById('slider-' + identifier);
        var valueElement = document.getElementById('price-range-value-' + identifier);
        var startInput = document.getElementById('slider-start-' + identifier);
        var endInput = document.getElementById('slider-end-' + identifier);

        if (sliderElement.noUiSlider) {
            sliderElement.noUiSlider.destroy();
        }
        noUiSlider.create(sliderElement, {
            start: [0, 500000],
            connect: true,
            range: {
                'min': 0,
                '10%': 30000,
                '20%': 50000,
                '30%': 100000,
                '50%': 200000,
                '70%': 300000,
                '90%': 400000,
                'max': 500000
            },
            snap: true // 스냅 기능 활성화
        });

        // 슬라이더 출력 값 띄우는 함수
        sliderElement.noUiSlider.on('update', function (values, handle) {
            var startValue = parseInt(values[0]);
            var endValue = parseInt(values[1]);

            if (endValue === 500000){
                valueElement.innerText = startValue + '원 - ' + '500,000원 이상';
            } else {
                valueElement.innerText = startValue + '원 - ' + endValue + '원 미만';
            }

            startInput.value = startValue;
            endInput.value = endValue;
        });
    }


    // 지도 보기 버튼 클릭 시 지도 출력
    function showmap() {
        $("#search_bar").css("display", "none");
        $("#main-filter").css("display", "none");
        $("#searchbar").css("display", "none");
        $("#modal-wrap").css("display", "flex");
        $("body").css("overflow", "hidden");
        $("footer").css("display", "none");
        loadTmap();

        // 모달 슬라이더 초기화
        initializeSlider('modal');
    }

    // 지도 출력 함수
    $("#modal_close").click(function () {
        $("#search_bar").css("display", "flex");
        $("#main-filter").css("display", "flex");
        $("#modal-wrap").css("display", "none");
        $("#searchbar").css("display", "flex");
        $("body").css("overflow", "auto");
        $("footer").css("display", "flex");

        // 메인 슬라이더 재초기화
        initializeSlider('main');
    });

    /*----------------------티맵 관련 스크립트------------------------*/
    var markers = [];
    var map;

    //티맵 호출 함수
    function initTmap() {
        map = new Tmapv2.Map("tmap", {
            center: new Tmapv2.LatLng(37.56520450, 126.98702028),
            width: "100%", // 지도의 넓이
            height: "100%", // 지도의 높이
            zoom: 17
        });
        addMarkersTooMuch(); // 100개의 마커 추가
    }

    //티맵 리로드 모달때문에 한번 초기화 필요
    function loadTmap() {
        if (typeof Tmapv2 === 'undefined') {
            var script = document.createElement('script');
            script.src = 'https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=NzqUDqweAh8UqE9Z07ze639x6Wlbcgya9sqhnjXH';
            script.onload = initTmap;
            document.body.appendChild(script);
        } else {
            initTmap();
        }
    }

    //마커 추가하는 함수
    function addMarkersTooMuch() {
        removeMarkers();
        for (var i = 0; i < 100; i++) {
            var lat = Math.random() / 100;
            var lng = Math.random() / 100;
            //Marker 객체 생성.
            var marker = new Tmapv2.Marker({
                position: new Tmapv2.LatLng(37.56220450 + lat, 126.98402028 + lng), //Marker의 중심좌표 설정.
                label: 'test' //Marker의 라벨.
            });
            marker.setMap(map); //Marker가 표시될 Map 설정.
            markers.push(marker);
        }
    }

    // 모든 마커를 제거하는 함수입니다.
    function removeMarkers() {
        for (var i = 0; i < markers.length; i++) {
            markers[i].setMap(null);
        }
        markers = [];
    }
</script>
</body>
</html>
