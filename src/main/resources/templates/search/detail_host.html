<!DOCTYPE html>
<html lang="ko" layout:decorate="~{layout/main}"
      layout:fragment="main"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
</head>
<body class="overflow-y-auto">
<div 
        class="w-full bg-[#fff] lg:h-auto lg:min-h-[6445] sticky border-b-[1px] border-t-[1px]"
>
    <header class=" top-0 left-0 w-[1200px] mx-auto flex flex-col items-start justify-start max-w-full text-left text-[15.1px] text-[#707070] font-[Inter] z-50">
        <div class="simple-list-example-scrollspy w-full self-stretch bg-[#fff] border-[#ebebeb]  border-solid flex flex-row items-start justify-start pt-[34.5px] px-[392px] pb-[33px] gap-[52.8px] lg:pl-[23px] lg:pr-[196px] lg:box-border mq450:pl-[20px] mq450:pr-[20px] mq450:box-border mq750:gap-[26px] mq750:pl-[98px] mq750:pr-[98px] mq750:box-border whitespace-nowrap"
             id="simple-list-example"
             style="display: flex; grid-auto-flow: column;">
            <a class="[text-decoration:none] font-medium text-[inherit] inline-block min-w-[31px] flex-shrink-0"
               href="#simple-list-item-1">개요</a>
            <a class="[text-decoration:none] text-[15px] font-medium text-[inherit] inline-block min-w-[118.6px] flex-shrink-0"
               href="#simple-list-item-2">서비스 및 부대시설</a>
            <a class="[text-decoration:none] font-medium text-[inherit] inline-block min-w-[31px] flex-shrink-0"
               href="#simple-list-item-3">객실</a>
            <a class="[text-decoration:none] font-medium text-[inherit] inline-block min-w-[31px] flex-shrink-0"
               href="#simple-list-item-4">위치</a>
            <a class="[text-decoration:none] font-bold text-[#1273e4] inline-block min-w-[31px] flex-shrink-0"
               href="#simple-list-item-5">리뷰</a>
        </div>
    </header>
</div>

<main  class="flex flex-col items-center justify-start w-full pt-[100px] lg:pt-[100px]" id="simple-list-item-1">

    <div class="flex flex-col lg:flex-row items-center justify-center w-full max-w-[1560px] gap-8 px-4 sm:px-6 lg:px-0">
        <!-- 큰 이미지 (hostImages[0]) -->
        <div class="relative w-full lg:max-w-[640px] h-[546px] mb-8 lg:mb-0 rounded-[12px]">
            <img alt=""
                 class="absolute inset-0 w-full h-full object-cover rounded-[12px]" 
                 loading="lazy"
                 th:if="${hostImages != null and hostImages.size() > 1}"
                 th:src="${hostImages[0] != null} ? @{|https://storage.googleapis.com/omastay/host/${hostImages[0].imgName.fName}|} : @{/image/detail/imagex.png}" />
        </div>
    
        <div class="w-full lg:max-w-[552px] aspect-square grid grid-cols-2 gap-4">
            <!-- 작은 이미지 1 (hostImages[1]) -->
            <div class="relative w-full h-[250px] rounded-[12px]">
                <img alt=""
                     class="absolute inset-0 w-full h-full object-cover rounded-[12px]"
                     loading="lazy"
                     th:if="${hostImages != null and hostImages.size() > 1}"
                     th:src="${hostImages[1] != null} ? @{|https://storage.googleapis.com/omastay/host/${hostImages[1].imgName.fName}|} : @{/image/detail/imagex.png}" />
            </div>
    
            <!-- 작은 이미지 2 (hostImages[2]) -->
            <div class="relative w-full h-[250px] rounded-[12px]">
                <img alt=""
                     class="absolute inset-0 w-full h-full object-cover rounded-[12px]"
                     loading="lazy"
                     th:if="${hostImages != null and hostImages.size() > 1}"
                     th:src="${hostImages[2] != null} ? @{|https://storage.googleapis.com/omastay/host/${hostImages[2].imgName.fName}|} : @{/image/detail/imagex.png}" />
            </div>
    
            <!-- 작은 이미지 3 (roomImages[0]) -->
            <div class="relative w-full h-[250px] rounded-[12px]">
                <img alt=""
                     class="absolute inset-0 w-full h-full object-cover rounded-[12px]"
                     loading="lazy"
                     th:if="${roomImages != null and roomImages.size() > 1}"
                     th:src="${roomImages[0] != null} ? @{|https://storage.googleapis.com/omastay/room/${roomImages[0].imgName.fName}|} : @{/image/detail/imagex.png}" />
            </div>
    
            <!-- 작은 이미지 4 + 버튼 (roomImages[1]) -->
            <div class="relative w-full h-[250px] rounded-[12px]">
                <img alt=""
                     class="absolute inset-0 w-full h-full object-cover rounded-[12px]"
                     loading="lazy"
                     th:if="${roomImages != null and roomImages.size() > 1}"
                     th:src="${roomImages[1] != null} ? @{|https://storage.googleapis.com/omastay/room/${roomImages[1].imgName.fName}|} : @{/image/detail/imagex.png}" />
    
                <button id="allPhotoBtn" class="cursor-pointer [border:none] bg-white h-[40px] min-w-[150px] shadow-[0px_2px_8px_rgba(0,_0,_0,_0.24)] rounded-full whitespace-nowrap hover:bg-[#e6e6e6] absolute bottom-4 right-4 font-bold p-0 text-[12px] flex items-center justify-center">
                    <div class="flex items-center justify-start">
                        사진 모두보기 <img alt="" class="h-[16px] w-[16px] mr-2" src="/image/detail/svg.svg"/>
                    </div>
                </button>
            </div>
        </div>
    </div>
    
    

    <div id="allPhotomodal" th:each="hostInfo : ${hostInfo}" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-[9999] to-50%">
        <!--사진 모두보기 모달-->
        <div id="photoModal-body">
        <div
        class="rounded-lg shadow-md bg-white h-[730px] w-[1082px] max-w-full overflow-hidden flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[14px] box-border gap-[11.5px] leading-[normal] tracking-[normal] text-center text-[13px] text-[#939393] font-[Inter] mx-auto" 
        >
        <header
        class="self-stretch flex flex-col items-start justify-start text-left text-[18px] text-[#333] font-[Inter]"
        >
        <div
            class="self-stretch rounded-[13px] overflow-hidden flex flex-row items-start justify-start py-[19px] px-[444px] gap-[416px] mq450:gap-[112px] mq725:gap-[225px] mq725:flex-wrap"
            >
            
            <div
            class="flex flex-col items-start justify-start pt-[5.5px] px-[0px] pb-[0px]"
            >
            <a th:text="${hostInfo.hname}"
            class="[text-decoration:none] relative leading-[22px] font-bold text-[inherit] whitespace-nowrap"
            ></a
            >
        </div>
        <button id="photoCloseBtn">
        X
        </button>
            </div>
            <div
            class="w-[186px] flex flex-row items-start justify-start py-[0px] px-[22px] box-border text-center text-[15.1px] text-[#707070] pb-[8px]"
            >
            <div class="flex-1 flex flex-row items-start justify-start">
                <button id="hostImgBtn" class="flex-1 relative font-medium pb-[17px]">숙소</button>
                <button id="roomImgBtn" class="flex-1 relative font-medium pb-[17px]">객실</button>
            </div>
            </div>
        </header>
        <div id="roomNameBox"
            class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[22px] pr-[15px] box-border max-w-full" style="display: none;"
        >
            <div
            class="flex-1 flex flex-row items-start justify-between max-w-full gap-[20px] mq1050:flex-wrap"
            >
            <div
                class="w-[960px] flex flex-col items-start justify-start pt-[2px] px-[0px] pb-[0px] box-border max-w-full"
            >
                <div
                class="self-stretch flex flex-row items-start justify-start gap-[15px] mq1000:flex-wrap"
                >
                <button  id="allhotelRoomBtn" th:each="allRoomName : ${allRoom}" 
                    class="flex-1 flex flex-row items-start justify-start py-[0px] px-[12px] box-border relative min-w-[176px] max-w-[180px]"
                    >
                    <div id="detailRoomBtn" th:text="${allRoomName.roomName}"
                    class="flex-1 relative border border-gray-400 font-semibold cursor-pointer bg-white h-[31px] min-w-[150px]  rounded-full whitespace-nowrap hover:bg-[#e6e6e6] p-0 flex items-center justify-center z-[1]"
                    >
                    </div>
                </button>
                </div>
            </div>
           
            </div>
        </div>
        <section
            class="self-stretch flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[6.5px] box-border max-w-full"
        >
            <!-- 호스트 이미지 슬라이드 -->
            <div id="hostImageBox" class="flex-1 bg-[#e9e9e9] flex flex-row items-center justify-center hidden" style="height: 545px;">
                <button id="prevHostImageBtn" class="w-[40px] h-[40px] shadow-[0px_2px_8px_rgba(0,_0,_0,_0.24)] rounded-[9999px] bg-[#fff]">
                    &lt;
                </button>
                <img id="hostSlideImage" th:src="@{|https://storage.googleapis.com/omastay/host/${hostImages[0].imgName.fName}|}" 
                    alt="호스트 이미지" class="w-[575px] max-h-full object-cover" style="height: 545px;" />
                <button id="nextHostImageBtn" class="w-[40px] h-[40px] shadow-[0px_2px_8px_rgba(0,_0,_0,_0.24)] rounded-[9999px] bg-[#fff]">
                    &gt;
                </button>
            </div>

            <!-- 객실 이미지 슬라이드 -->
            <div id="roomImageBox" class="flex-1 bg-[#e9e9e9] flex flex-row items-center justify-center" style="height: 500px;">
                <button id="prevRoomImageBtn" class="w-[40px] h-[40px] shadow-[0px_2px_8px_rgba(0,_0,_0,_0.24)] rounded-[9999px] bg-[#fff]">
                    &lt;
                </button>
                <img id="roomSlideImage" th:src="@{|https://storage.googleapis.com/omastay/room/${roomImages[0].imgName.fName}|}" 
                    alt="객실 이미지" class="w-[500px] max-h-full object-cover" style="height: 500px;" />
                <button id="nextRoomImageBtn" class="w-[40px] h-[40px] shadow-[0px_2px_8px_rgba(0,_0,_0,_0.24)] rounded-[9999px] bg-[#fff]">
                    &gt;
                </button>
            </div>

        </section>
        <section
            class="flex flex-row items-start justify-start py-[0px] px-[18px] box-border max-w-full"
        >
            <div
            class="flex flex-row items-start justify-center gap-[10px] max-w-full mq1050:flex-wrap"
            >

            </div>
        </section>
        </div>
    </div>
    </div>

    <section th:each="host : ${hostInfo}"
            class="w-[1223px] flex flex-col items-start justify-start py-[0px] pl-[0px] pr-[20px] box-border gap-[26.6px] max-w-full text-left text-[18px] text-[#333] font-[Inter]"
    >
        <div 
                class="flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[36.4px] box-border gap-[32px] max-w-full shrink-0 text-[32px]"
        >
            <div 
                    class="w-auto flex flex-col items-start justify-start gap-[9px] max-w-full"
            >
                <h1 id="simple-list-item-2" th:text="${host.hname}"
                        class="m-[0px] self-stretch h-[44px] relative text-inherit leading-[44px] font-bold font-[inherit] flex items-center shrink-0 mq450:text-[19px] mq450:leading-[26px] mq1050:text-[26px] mq1050:leading-[35px] mt-5"
                >
                </h1>
                <div
                        class="flex flex-row items-start justify-start gap-[5px] text-[16px] mb-[-40px]"
                >
                    <div
                            class="flex flex-col items-start justify-start pt-[2.7px] px-[0px] pb-[0px]"
                    >
                    <img alt="" class="h-[15px] w-[15px] relative min-h-[15px]" src="/image/detail/star1.svg">
                    </div>
                    <b th:text="${#strings.listSplit(reviewStats, ',')[0]}"
                            class="h-[27px] relative text-[15.5px] flex items-center min-w-[27px]"
                    ></b
                    >
                    <div th:text="${#strings.listSplit(reviewStats, ',')[1]}+'명 평가'"
                            class="h-[27px] relative tracking-[-0.18px] font-medium text-[#999] flex items-center min-w-[92px]"
                    >
                    </div>
                    <button onclick="location.href='#review-section';"
                            class="h-[27px] w-[79px] relative font-semibold text-[#1273e4] text-center flex items-center justify-center shrink-0"
                    >
                        리뷰보기
                    </button>
                </div>
            </div>
            
        </div>
        <div
                class="self-stretch flex flex-col items-start justify-start gap-[33px] max-w-full shrink-0"
        >
            <div
                    class="self-stretch flex flex-row items-start justify-start pt-[0px] pb-[32.5px] pl-[3px] pr-[0px] box-border max-w-full"
            >
                <div
                        class="flex-1 flex flex-col items-start justify-start gap-[22px] max-w-full"
                >
                    <div class="self-stretch h-[1px] relative bg-[#ebebeb]" id="simple-list-item-3"></div>
                    <b class="self-stretch relative">서비스 및 부대시설</b>
                    <div
                    class="flex flex-wrap items-start justify-start py-[1px] pl-[0px] pr-[21px] box-border gap-[20px] max-w-full text-[14.1px] text-[#707070] max-w-[1200px]"
                >
                    <div th:each="facility : ${facilities}" class="flex items-center gap-2">
                        <img th:src="@{/image/detail/{sanitizedName}.svg(sanitizedName=${#strings.replace(facility.fCate, '/', '')})}" alt="Facility Image" class="w-6 h-6">
                        <p th:text="${facility.fCate}" class="text-base"></p>
                    </div>
                </div>
                            </div>
                        </div>
                    </div>
                    <div class="self-stretch h-[1px] relative bg-[#ebebeb]"></div>
            <div
                    class="self-stretch flex flex-col items-start justify-start gap-[33px] max-w-full"
            >
                <b class="self-stretch relative">객실 선택</b>
                <div id="roomList" th:each="room : ${roomInfo}"
                        class="self-stretch rounded-[16px] bg-[#f1f5fb] overflow-hidden flex flex-row items-start justify-start pt-[38px] px-[39px] pb-[39px] box-border gap-[26px] max-w-full text-[23.9px] text-[#707070] mq1050:flex-wrap"
                >
                    <img
                            alt=""
                            class="w-[360px] h-[320px] relative rounded-[12px] max-h-full overflow-hidden shrink-0 object-cover max-w-full mq1050:flex-1"
                            loading="lazy"
                            th:src="${matchImages[room.id]}"
                    />

                    <div
                            class="flex-1 flex flex-col items-start justify-start pt-[8px] px-[0px] pb-[0px] box-border min-w-[464px] max-w-full mq750:min-w-full"
                    >
                        <div
                                class="self-stretch flex flex-col items-start justify-start gap-[8px] max-w-full"
                        >
                            <div
                                    class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[11px] pr-[0px] box-border max-w-full text-[#333]"
                            >
                                <div
                                        class="flex-1 flex flex-col items-start justify-start max-w-full"
                                >
                                    <b th:text="${room.roomName}"
                                            class="w-[168px] relative flex items-center mq450:text-[19px]"
                                    ></b
                                    >
                                    <div
                                            class="self-stretch flex flex-row items-start justify-end text-center text-[14px] text-[#1273e4]"
                                    >
                                        <button th:attr="data-room-id=${room.id}"
                                                class="detailRoomInfoBtn w-[80px] relative font-semibold flex items-center justify-center shrink-0"
                                        >
                                            상세 정보 &gt;
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div
                                    class="self-stretch flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[5px] box-border max-w-full text-[16px]"
                            >
                                <div
                                        class="flex-1 rounded-[10px] bg-[#fff] flex flex-row items-start justify-start pt-[29.8px] pb-[25px] pl-[28px] pr-[22px] box-border gap-[10.8px] max-w-full mq750:flex-wrap"
                                >
                                    <div class="h-[14.4px] w-[14.4px] relative">
                                        <img
                                                alt=""
                                                class="absolute top-[3px] left-[6.3px] w-[3.7px] h-[7.3px] z-[1]"
                                                src="/image/detail/vector-2.svg"
                                        />

                                        <img
                                                alt=""
                                                class="absolute top-[0px] left-[0px] w-full h-full z-[2]"
                                                src="/image/detail/vector-3.svg"
                                        />
                                    </div>
                                    <div
                                            class="flex-1 flex flex-col items-start justify-start min-w-[411px] max-w-full mq750:min-w-full"
                                    >
                                        <div
                                                class="w-[87px] flex flex-row items-start justify-start"
                                        >
                                            <div
                                                    class="w-[37px] flex flex-col items-start justify-start gap-[12px]"
                                            >
                                                <div
                                                        class="self-stretch relative leading-[14px] z-[1]"
                                                >
                                                </div>
                                                <div class="self-stretch relative z-[1]">
                                            
                                                </div>
                                            </div>
                                            <div
                                                    class="flex-1 flex flex-col items-start justify-start gap-[12px]"
                                            >
                                                <div th:text="${host.checkin}"
                                                        class="w-[47px] relative leading-[14px] flex items-center whitespace-nowrap z-[1]"
                                                >
                                                </div>
                                                <div
                                                        class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[3px] pr-[0px]"
                                                >
                                                    <div th:text="${host.checkout}"
                                                            class="flex-1 relative whitespace-nowrap z-[1]"
                                                    >
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                                class="self-stretch flex flex-row items-start justify-end mt-[-48px] text-[12.3px] text-[#999]"
                                        >
                                            <div
                                                    class="w-[170px] flex flex-col items-end justify-start gap-[30px]"
                                            >
                                                <div
                                                        class="self-stretch flex flex-col items-start justify-start gap-[7px]"
                                                >
                                                    <div
                                                            class="flex flex-row items-end justify-start py-[0px] pl-[0px] pr-[2px]"
                                                    >
                                                        <div
                                                                class="flex flex-col items-start justify-end pt-[0px] px-[0px] pb-[3px]"
                                                        >
                                                        </div>
                                                        <div
                                                                class="flex flex-col items-start justify-end pt-[0px] pb-[1px] pl-[0px] pr-[5px] text-[13px]"
                                                        >
                                                        </div>
                                                        <div
                                                                class="flex flex-col items-start justify-end pt-[0px] px-[0px] pb-[1px] text-[17.3px] text-[#333]"
                                                        >
                                                            <div th:text="${roomPrices[room.id]}"
                                                                    class="relative font-extrabold inline-block min-w-[75.6px] z-[1]" style="left:60px"
                                                            >
                                                            </div>
                                                        </div>
                                                        <b
                                                                class="relative text-[15px] inline-block text-[#333] min-w-[15px] z-[2]" style="left:64px"
                                                        >원</b
                                                        >
                                                    </div>
                                                    <div
                                                            class="self-stretch flex flex-row items-start justify-end text-[11px] text-[#f45858]"
                                                    >
                                                       
                                                    </div>
                                                </div>
                                                <div
                                                        class="flex flex-row items-start justify-end py-[0px] px-[5px]"
                                                >
                                                    <button   th:attr="data-room=${room.id}, data-price=${roomPrices[room.id]}" onclick="reservationBtnClick(this)"
                                                            class="cursor-pointer [border:none] py-[9px] px-[10px] bg-[#1273e4] rounded-[8px] flex flex-row items-start justify-start whitespace-nowrap hover:bg-[#3899ff]"
                                                    >
                                                            <div 
                                                                    class="relative text-[12px] font-semibold font-[Inter] text-[#fff] text-center inline-block min-w-[52px]"
                                                            >
                                                                객실 예약
                                                            </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div
                                    class="self-stretch rounded-[8px] bg-[#fff] flex flex-row items-start justify-start pt-[12px] px-[12px] pb-[45px] [row-gap:20px] text-[10px] mq450:flex-wrap"
                            >
                                <div
                                        class="w-[43px] relative font-semibold flex items-center shrink-0"
                                >
                                    객실정보
                                </div>
                                <div th:text="'인원:'+${room.roomPerson}"
                                        class="w-[86px] relative text-[9.8px] font-semibold flex items-center shrink-0"
                                >
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--객실이 없는 경우-->
                <div id="noRoomMessage" class="flex flex-col items-center justify-center w-full h-full text-center py-20 bg-[#f9fafb] rounded-[16px]">
                    <div class="text-[23.9px] text-[#707070] font-semibold mb-4">
                        선택한 날짜의 객실은 매진되었어요
                    </div>
                    <div class="text-[14px] text-[#999] mb-8">
                        상단 검색창에서 날짜나 인원을 다시 설정해 보세요.
                    </div>
                    <button onclick="location.href='#review-section'; window.scrollTo({top: 0, behavior: 'smooth'});" class="bg-white text-[#1273e4] font-semibold py-2 px-6 rounded-[8px] border border-[#e5e7eb] hover:bg-[#f3f4f6]">
                        일정 변경
                    </button>
                </div>
                <!--객실이 없는 경우-->
            </div>

            <!--상세정보 모달-->
            <div th:attr="id='detailRoomModal_' + ${room.id}" th:each="room : ${roomInfo}" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-[9999] to-50%"> 
                <div id="roomModalContent" >
                    <div class="mx-auto p-[40px] pt-[42px] pb-[42px] bg-white rounded-lg shadow-md min-w-[300px] max-w-[570px] max-h-[3066px] flex flex-col gap-6">
                        <div class="flex items-center justify-between w-full">
                        <h2 class="font-extrabold text-gray-950 pl-4 pr-2" style="font-size: 24px;">객실 상세정보</h2>
                        <button th:attr="data-room-id=${room.id}" class="roomInfoDelBtn flex items-center ml-[58px]">
                            X
                        </button>
                        </div>
                        <h1 th:text="${room.roomName}" class="text-lg font-bold pl-4 pr-2"></h1> 
                
                        <div class="flex flex-col gap-6">
                        <div class="flex flex-col gap-4">
                            <h2 class="font-bold text-gray-700 pl-4 pr-2">객실 정보</h2>
                            <div class="border-t border-gray-300"></div>
                            <p th:text="'입실:'+${host.checkin}" class="text-sm text-gray-600 pl-4 pr-2"></p>
                            <p th:text="'퇴실:'+${host.checkout}" class="text-sm text-gray-600 pl-4 pr-2"></p>
                        </div>
                
                        <div class="flex flex-col gap-4">
                            <h2 class="font-bold text-gray-700 pl-4 pr-2">객실 소개</h2>
                            <div class="border-t border-gray-300"></div>
                            <ul class="list-disc list-inside text-sm text-gray-600 pl-5"> 
                            <li th:text="${room.roomIntro}" class="indent-[-1.25rem] pl-4 pr-2"></li>
                            </ul>
                        </div>
                
                        <div class="flex flex-col gap-4">
                            <h2 class="font-bold text-gray-700 pl-4 pr-2">숙소 이용 안내</h2>
                            <div class="border-t border-gray-300"></div>
                            <ul class="list-disc list-inside text-sm text-gray-600 pl-5">
                            <li th:text="${host.rules}" class="indent-[-1.25rem] pl-4 pr-2"></li>
                            </ul>
                        </div>
                        </div>
                    </div>
                </div>
            </div>

            <div
                    class="self-stretch flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[18px] box-border gap-[33px] max-w-full text-[23.9px] text-[#707070]"
            >

                <div class="self-stretch h-[1px] relative bg-[#ebebeb]"></div>
            </div>
            <div
            class="w-[1135px] flex flex-col items-start justify-start gap-[26.6px] max-w-full text-[15px]"
    >
        <b
                class="relative text-[18px] tracking-[-0.07px] inline-block min-w-[116px]"
        >숙소 소개</b
        >
        <div class="self-stretch relative leading-[22px] text-[#707070]">
            <ul class="m-[0px] font-[inherit] text-inherit pl-[20px] ml-[20px]">
                <li th:text="${host.hostOwnerInfo.hintro}" class="mb-[0px]">
                </li>
                
            </ul>
        </div>
    </div>
            <div
                    class="w-[1135px] flex flex-col items-start justify-start gap-[26.6px] max-w-full text-[15px]"
            >
                <b
                        class="relative text-[18px] tracking-[-0.07px] inline-block min-w-[116px]"
                >숙소 이용 정보</b
                >
                <b
                        class="relative tracking-[-0.37px] inline-block text-[#49627a] min-w-[91px] ml-[20px]"
                >기본 정보</b
                >
                <div class="self-stretch relative leading-[22px] text-[#707070]">
                    <ul class="m-[0px] font-[inherit] text-inherit pl-[20px] ml-[20px]">
                        <li th:text="${host.rules}"  class="mb-[0px]">
                        </li>
                    </ul>
                </div>
                <b
                class="relative tracking-[-0.37px] inline-block text-[#49627a] min-w-[91px] ml-[20px]"
        >숙소 이용 시간</b
        >
        <div class="self-stretch relative leading-[22px] text-[#707070]">
            <ul class="m-[0px] font-[inherit] text-inherit pl-[20px] ml-[20px]">
                <li th:text="'입실:'+${host.checkin}" class="mb-[0px]">
                </li>
                <li th:text="'퇴실:'+${host.checkout}" class="mb-[0px]">
                </li>
            </ul>
        </div>
             <b
                        class="relative tracking-[-0.37px] inline-block text-[#49627a] min-w-[91px] ml-[20px]"
                >요금 상세 안내</b
                >
                <div class="self-stretch relative leading-[22px] text-[#707070]">
                    <ul class="m-[0px] font-[inherit] text-inherit pl-[20px] ml-[20px]">
                        <li th:text="${host.priceAdd}" class="mb-[0px]">
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div
                class="self-stretch flex flex-col items-start justify-start pt-[0px] px-[0px] pb-[6.4px] box-border gap-[25.6px] max-w-full shrink-0"
        >
        
            <div
                    class="w-[418px] flex flex-col items-start justify-start gap-[26.6px] max-w-full mt-[40px]"
            >
                <b id="map_section" class="w-[143px] relative flex items-center"
                >취소 및 환불 규정</b
                >
                <div
                        class="self-stretch relative text-[15px] leading-[44px] text-[#707070]"
                >
                    <ul class="m-[0px] font-[inherit] text-inherit pl-[20px] ml-[20px]">
                        <li class="w-[500px]">
                            객실별 취소 정책이 상이하니 '숙소 이용 정보'에서 확인해주세요.
                        </li>
                    </ul>
                </div>
            </div>
            <div
                    class="self-stretch h-[15.5px] flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[14.5px] box-border max-w-full"
            >
                <div
                        class="self-stretch flex-1 relative bg-[#ebebeb] max-w-full"
                ></div>
            </div>
            <div
                    class="w-[1185px] flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[14.4px] box-border max-w-full"
            >
                <div
                        class="flex-1 flex flex-row items-start justify-between max-w-full gap-[20px] mq450:flex-wrap"
                >
                    <b class="w-[100px] relative flex items-center shrink-0"
                    >호스트 정보</b
                    >
                    <div
                            class="w-[144px] flex flex-col items-start justify-start pt-[2.5px] px-[0px] pb-[0px] box-border text-center text-[16px] text-[#5f84a1]"
                    >
                        <button class="self-stretch h-[16px] relative font-semibold flex items-center shrink-0"
                                id="detailHostBtn"
                        >
                        <span>
                        <span id="simple-list-item-4">호스트 정보 보기</span>
                        <span class="text-[18px]"> </span>
                        <span class="text-[20px]">&gt;</span>
                        </span>
                        </button>
                    </div>
                </div>
                <!--호스트 정보 모달--> 
                <div id="detailHostModal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-[9999] to-50%"> 
                     <div id="hostModalContent">
                        <div
                        class="w-[381px] h-[562px] bg-white rounded-[13px] overflow-hidden flex flex-col items-start justify-start pt-[23px] pb-[58px] pl-[14px] pr-[9px] relative gap-[17px] text-left text-[14px] text-[#777] font-Inter shadow-md mt-0" style = "top:28px"
                        >
                        <header
                        class="w-[331px] flex flex-row items-end justify-start max-w-full text-left text-[19.2px] text-[#4f4f4f] font-Inter"
                        >
                        <div
                        class="w-[128px] flex flex-col items-start justify-start gap-[36px]"
                        >
                        <button id="hostInfoDelBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 text-2xl font-bold close">&times;</button>
                       
                        <div
                            class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[21px] pr-[0px]"
                        >
                            <div
                            class="h-[312px] flex-1 flex flex-col items-start justify-start"
                            >
                            <div
                                class="self-stretch h-[54px] relative bg-[#f7f7f7] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-r-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0"
                            ></div>
            
                            <div
                                class="self-stretch h-[54px] relative bg-[#f7f7f7] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-r-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0"
                            ></div>
                            <div
                                class="self-stretch h-[54px] relative bg-[#f7f7f7] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-r-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[1]"
                            ></div>
                            <div
                                class="self-stretch h-[54px] relative bg-[#f7f7f7] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-r-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[3]"
                            ></div>
                            <div
                                class="self-stretch h-[54px] relative bg-[#f7f7f7] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-r-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[5]"
                            ></div>
                            <div
                                class="self-stretch h-[54px] relative bg-[#f7f7f7] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-r-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[7]"
                            ></div>
                            </div>
                        </div>
                        </div>
                        <div class="flex-1 flex flex-col items-start justify-start gap-[41px]">
                        <a
                            class="[text-decoration:none] relative leading-[20px] font-semibold text-[inherit] inline-block min-w-[101px] whitespace-nowrap"
                            >판매자 정보</a
                        >
                        <div
                            class="self-stretch h-[312px] flex flex-col items-start justify-start"
                        >
                            <div
                            class="self-stretch h-[54px] relative bg-[#fff] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0"
                            ></div>
                            <div
                            class="self-stretch h-[54px] relative bg-[#fff] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0"
                            ></div>
                            <div
                            class="self-stretch h-[54px] relative bg-[#fff] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[2]"
                            ></div>
                            <div
                            class="self-stretch h-[54px] relative bg-[#fff] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[4]"
                            ></div>
                            <div
                            class="self-stretch h-[54px] relative bg-[#fff] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[6]"
                            ></div>
                            <div
                            class="self-stretch h-[54px] relative bg-[#fff] border-[#bcbcbc] border-t-[1px] border-solid border-[#bcbcbc] border-b-[1px] border-solid box-border shrink-0 z-[8]"
                            ></div>
                        </div>
                        </div>
                    </header>
                    <div
                    class="w-[71px] absolute !m-[0] top-[106px] left-[51px] leading-[20px] font-semibold flex items-center z-[1]"
                    >
                    상호
                    </div>
                    <div th:text="${host.hname}"
                    class="ml-[6px]w-[165px] absolute !m-[0] top-[106px] right-[103px] leading-[20px] font-semibold flex items-center z-[1]" style="left: 155px; top: 95px;"
                    >
                    
                    </div>
                    <div
                    class="w-[71px] absolute !m-[0] top-[160px] left-[51px] leading-[20px] font-semibold flex items-center z-[1]"
                    >
                    대표자명
                    </div>
                    <div th:text="${host.hostOwnerInfo.hostName}"
                    class="w-[45px] absolute !m-[0] top-[160px] right-[159px] leading-[20px] font-semibold flex items-center z-[1]" style="left: 158px;"
                    >
                    </div>
                    <div
                    class="w-[71px] absolute !m-[0] top-[214px] left-[51px] leading-[20px] font-semibold flex items-center z-[2]"
                    >
                    주소
                    </div>
                    <div th:text="${host.addressVo.street}"
                    class="absolute !m-[0] top-[214px] right-[116px] leading-[20px] font-semibold inline-block min-w-[83px] z-[3] w-[204px]"
                    style="left: 157px; top: 202px;">
                    </div>
                    <div
                    class="w-[71px] absolute !m-[0] top-[269px] left-[51px] leading-[20px] font-semibold flex items-center z-[4]"
                    >
                    전화번호
                    </div>
                    <div th:text="${host.hphone}" 
                    class="absolute !m-[0] top-[269px] right-[83px] leading-[20px] font-semibold inline-block min-w-[120px] z-[5]" style="left: 157px;"
                    >
                    </div>
                    <div 
                    class="w-[71px] absolute !m-[0] bottom-[221px] left-[51px] leading-[20px] font-semibold flex items-center z-[6]"
                    >
                    이메일
                    </div>
                    <div th:text="${host.hostContactInfo.contactEmail}"
                    class="absolute !m-[0] bottom-[221px] right-[62px] leading-[20px] font-semibold inline-block min-w-[120px] z-[6]"
                    >
                    </div>
                    <section
                    class="w-[341px] flex flex-row items-start justify-start py-[0px] px-[18px] box-border max-w-full text-left text-[13.2px] text-[#993030] font-[Inter] mt-[10px]"
                    >
                    <div
                        class="h-[86px] flex-1 relative leading-[20px] font-semibold flex items-center"
                    >
                        <ul class="m-[0px] font-[inherit] text-inherit pl-[18px]">
                        <li class="mb-[0px]">
                            <span class="text-[#a2a2a2]">판매자 정보는</span>
                            <span
                            >판매자의 명시적 동의 없이 영리 목적의 마케팅·광고 등에 활용할 수
                            없습니다.</span
                            >
                        </li>
                        <li>
                            <span class="text-[#a2a2a2]"
                            >이를 어길 시 정보통신망법 등 관련 법령에 의거하여 과태료 부과
                            및 민형사상 책임을 지게 될 수 있습니다.</span
                            >
                        </li>
                        </ul>
                    </div>
                    </section>
                    <div
                    class="absolute !m-[0] bottom-[168px] left-[51px] leading-[20px] font-semibold inline-block min-w-[74px] z-[8]"
                    >
                    사업자 번호
                    </div>
                    <div th:text="${host.hphone}"
                    class="absolute !m-[0] right-[101px] bottom-[168px] leading-[20px] font-semibold inline-block min-w-[103px] z-[9]" style="left: 158px;"
                    >
                    </div>
                    </div>
                     </div>
                </div>
            <!--호스트 정보 모달 끝-->
            </div>
            <div
                    class="self-stretch h-[8.4px] flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[7.4px] box-border max-w-full"
            >
                <div
                        class="self-stretch flex-1 relative bg-[#ebebeb] max-w-full"
                ></div>
            </div>
            <div
                    class="w-[47px] flex flex-row items-start justify-start py-[0px] px-[1px] box-border"
            >
                <b class="flex-1 relative">위치</b>
            </div>
        </div>
        <div
                class="self-stretch flex flex-row items-start justify-start pt-[0px] pb-[69.4px] pl-[1px] pr-[7px] box-border max-w-full shrink-0 text-[14.2px] text-[#707070]"
        >
            <div
                    class="flex-1 flex flex-col items-start justify-start gap-[28px] max-w-full"
            >
                <div id="hostInfoBlockBox"
                        class="w-[1177px] flex flex-row items-start justify-start pt-[0px] px-[0px] pb-[5px] box-border max-w-full"
                >
                <div id="map" style="width:1177px;height:400px;"></div>
                </div>
                <div class="self-stretch flex flex-col items-start justify-start gap-[21px] max-w-full"
                     id="simple-list-item-5"
                >
                    <div
                            class="w-[251px] flex flex-col items-start justify-start gap-[21px]"
                    >
                        <div class="flex flex-row items-end justify-start gap-[4px]">
                            <b id="addressText" th:text="${host.addressVo.street}" class="relative leading-[22px] whitespace-nowrap"
                            ></b
                            >
                            <div
                                    class="flex flex-col items-start justify-end pt-[0px] px-[0px] pb-[3px]"
                            >
                            </div>
                            <div
                                    class="flex flex-col items-start justify-end pt-[0px] px-[0px] pb-[1px] text-[13.1px] text-[#1273e4]"
                            >
                            <a href="#" onclick="clip(); return false;">
                                <button
                                        class="relative font-semibold inline-block min-w-[78px] flex flex-row items-start justify-start"
                                >
                                    <img 
                                            alt=""
                                            class="w-[16px] h-[16px] relative"
                                            src="/image/detail/svg-1.svg"
                                    />
                                    주소복사
                                </button>
                            </a>
                            </div>
                        </div>
                        <div
                                class="h-[77px] relative text-[14.1px] leading-[22px] inline-block shrink-0"
                        >
                            <ul class="m-[0px] font-[inherit] text-inherit pl-[19px]">
                                <li th:if="${host.addressVo.detail != null and !#strings.isEmpty(host.addressVo.detail)}" th:text="'-'+${host.addressVo.detail}" class="mb-[0px]"></li>
                                <li th:text="'-'+${host.directions}" class="mb-[0px]" style="width: 810px"></li>
                            </ul>
                        </div>
                    </div>
                    <div
                            class="self-stretch h-[1px] flex flex-row items-start justify-start py-[0px] pl-[4px] pr-[0px] box-border max-w-full"
                    >
                        <div id="hostInfoBlockLine"
                                class="self-stretch flex-1 relative bg-[#ebebeb] max-w-full"
                        ></div>
                    </div>
                </div>
                <div
                        class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[38px] pr-[34px] box-border max-w-full text-center text-[30px]"
                >
                    <h2 id="review-section"
                            class="m-[0px] h-[60px] flex-1 relative text-inherit font-bold font-[inherit] flex items-center justify-center max-w-full mq450:text-[18px] mq1050:text-[24px]"
                    >
                        호텔은 만족스러우셨나요?
                    </h2>
                </div>
            <div class="d-grid gap-2">
                <button id="reviewInsertBtn" type="button" class="btn btn-outline-primary ml-[38px] w-[1123px] h-[60px] mt-[-11px]">리뷰 작성하기</button>
            </div>

           <!-- 모달 -->
            <div id="myModal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-[9999] to-50%">
                <!-- AJAX로 불러온 HTML을 여기에 삽입 -->
                <div id="modal-body"></div>
            </div>
            
            
            </div>
        </div>
            <div id="modalBlockBox"
                class="self-stretch flex flex-row items-start justify-start pt-[0px] pb-[176.4px] pl-[8px] pr-[4px] box-border max-w-full shrink-0 text-[11.3px] text-[#49627a] z-0"
            >
                <div
                class="flex-1 flex flex-col items-start justify-start gap-[34.7px] max-w-full z-0"
                >
                <div
                    class="self-stretch flex flex-col items-start justify-start gap-[8px] max-w-full text-[17.2px] text-[#333]">
                    <div
                            class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[7px] pr-[9px] box-border max-w-full"
                    >
                        <div
                                class="flex-1 flex flex-row items-end justify-between flex-wrap content-end max-w-full gap-[20px]"
                        >
                            <div
                                    class="w-[302.4px] flex flex-col items-start justify-end pt-[0px] px-[0px] pb-[1px] box-border"
                            >
                                <div
                                        class="self-stretch flex flex-row items-start justify-start gap-[5px]"
                                >
                                    <b class="relative inline-block min-w-[73px]"
                                    >리얼 리뷰</b
                                    >
                                    <b th:text="${#strings.listSplit(reviewStats, ',')[0]}" class="relative inline-block min-w-[28px]">9.5</b>
                                    <div
                                            class="flex flex-col items-start justify-start pt-[1px] px-[0px] pb-[0px] text-[15.3px] text-[#c2c2c2]"
                                    >
                                        <div th:text="${#strings.listSplit(reviewStats, ',')[1]}+'개 리뷰'" class="relative font-semibold whitespace-nowrap">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div
                                    class="flex flex-row items-start justify-start gap-[0.5px] text-[13.1px]"
                            >

                                <button aria-expanded="false"
                                        class="relative font-semibold inline-block min-w-[40px] flex flex-row items-start justify-start"
                                        data-bs-display="static" data-bs-toggle="dropdown" type="button"
                                >
                                    <img
                                            alt=""
                                            class="h-[16px] w-[16px] relative min-h-[16px]"
                                            src="/image/detail/svg-2.svg"
                                    />
                                    <span id="recommSpan">추천순</span>
                                </button>
                                <div class="btn-group">
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item">추천순</a></li>
                                        <li><a class="dropdown-item">최신순</a></li>
                                        <li><a class="dropdown-item">평점 높은 순</a></li>
                                        <li><a class="dropdown-item">평점 낮은 순</a></li>
                                    </ul>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div  class="self-stretch h-[1px] relative bg-[#ebebeb]"></div>
                </div>
                <div
                       class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[22px] pr-[29px] box-border max-w-full"
                >
                <div id="reviewListContainer"  class="flex-1 flex flex-row items-start justify-start flex-wrap content-start gap-[72px] max-w-full">
                    </div>
                            </div>
                        </div>

                       

                        </div>
               
            </section>
        </main>
        <link href="/summernote/css/summernote-lite.css" rel="stylesheet">
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <script src="/summernote/js/summernote-lite.js"></script>
        <script src="/summernote/js/summernote-ko-KR.js"></script>
        <script type="text/javascript" src="/js/datepicker.js"></script>
        <script type="text/javascript" src="/js/countperson.js"></script>
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3abcdd2fabe9959bb4b086e4ea2c82ae"></script>
        <script th:inline="javascript">

            let ratingContainers;
            let currentRating;
            let isRatingInitialized = false;
            let user = JSON.parse(localStorage.getItem('user'));
            let scrollPosition = 0;
            const hIdx = /*[[${hIdx}]]*/ 0;
            console.log("호텔 번호 나와라"+hIdx);
            let isLogin = JSON.parse(localStorage.getItem('isLogin')) === true;
            var roomImages = /*[[${roomImages}]]*/ [];
            var hostImages = /*[[${hostImages}]]*/ [];
            var matchImages = /*[[${matchImages}]]*/ [];
            console.log("이미지"+JSON.stringify(matchImages));
            var allRoomIdx = /*[[${allRoom}]]*/ [];
            console.log("룸 idx임"+JSON.stringify(allRoomIdx));
            const roomInfo = /*[[${roomInfo}]]*/ [];
            console.log("룸 info"+roomInfo);
            var totalPrices = /*[[${totalPrices}]]*/ {};
            console.log(totalPrices);
            let oname;
            let fname;

            if (roomInfo === null || roomInfo.length === 0) { 
                        $('#noRoomMessage').removeClass('hidden');
                        $('#roomList').hide();
                    } else {
                        $('#noRoomMessage').addClass('hidden');
                        $('#roomList').show();
                    }
        

            var x = /*[[${hostInfo[0].xAxis}]]*/ '0'; 
            var y = /*[[${hostInfo[0].yAxis}]]*/ '0';

            var mapContainer = document.getElementById('map');
            var mapOption = {
                center: new kakao.maps.LatLng(y, x),
                level: 3 
            };

            var map = new kakao.maps.Map(mapContainer, mapOption);

            var markerPosition = new kakao.maps.LatLng(y, x);

            var marker = new kakao.maps.Marker({
                position: markerPosition
            });

            marker.setMap(map);
            
            function clip() {
                var address = document.getElementById('addressText').innerText;

                var textarea = document.createElement("textarea");
                document.body.appendChild(textarea);
                textarea.value = address;
                textarea.select();
                document.execCommand("copy");
                document.body.removeChild(textarea);

                alert("주소가 복사되었습니다");
            }
            
            //사진 모두보기 모달 생성(초기화)
            $(document).ready(function () {
                $('#allPhotoBtn').on('click', function () {
                    // 모달을 열 때 숙소 화면에 고정 및 초기화
                    $('#roomImageBox').addClass('hidden'); 
                    $('#hostImageBox').removeClass('hidden'); 

                    // 숙소, 객실 버튼 상태 초기화
                    $('#roomImgBtn').removeClass('text-blue-600 border-b-2 border-blue-600');
                    $('#hostImgBtn').addClass('text-blue-600 border-b-2 border-blue-600');

                    $('#roomImgBtn').addClass('text-gray-500');
                    $('#hostImgBtn').removeClass('text-gray-500');

                    const roomButtons = document.querySelectorAll('#allhotelRoomBtn');
                    roomButtons.forEach(button => {
                        const detailBtn = button.querySelector('#detailRoomBtn');
                        if (detailBtn) {
                            detailBtn.classList.remove('bg-blue-600', 'text-white');
                            detailBtn.classList.add('bg-white', 'text-gray-700', 'hover:bg-[#e6e6e6]');
                        }
                    });

                    $('#roomNameBox').hide(); 

                    $('#allPhotomodal').removeClass('hidden'); 

                    scrollPosition = $(window).scrollTop(); 
                    $('body').css({
                        'overflow': 'hidden', 
                        'position': 'fixed',
                        'top': `-${scrollPosition}px`,
                        'width': '100%'
                    });
                });

                // 사진 모두보기 모달 닫기 버튼 또는 모달 바깥 클릭 시
                $('#photoCloseBtn, #allPhotomodal').on('click', function (event) {
                    if (event.target.id === 'photoCloseBtn' || event.target.id === 'allPhotomodal') {
                        $('body').css({
                            'overflow': '',
                            'position': '',
                            'top': '',
                            'width': ''
                        });
                        $(window).scrollTop(scrollPosition);
                        $('#allPhotomodal').addClass('hidden'); 
                    }
                });
            });


            document.addEventListener('DOMContentLoaded', function() {
                // 숙소 이미지 전환 기능
                let currentHostIndex = 0;
                let activeButton = null;

                function updateHostImage() {
                    if (hostImages && hostImages.length > 0) {
                        const currentImage = hostImages[currentHostIndex];
                        if (currentImage.imgName && currentImage.imgName.fname) {
                            const imageUrl = `https://storage.googleapis.com/omastay/host/${currentImage.imgName.fname}`;
                            $('#hostSlideImage').attr('src', imageUrl);
                        } else {
                            console.log("Image at current index is missing imgName or fname.");
                        }
                    } else {
                        console.log("hostImages is not available yet.");
                    }
                }

                $('#prevHostImageBtn').on('click', function () {
                    currentHostIndex = (currentHostIndex === 0) ? hostImages.length - 1 : currentHostIndex - 1;
                    updateHostImage();
                });

                $('#nextHostImageBtn').on('click', function () {
                    currentHostIndex = (currentHostIndex === hostImages.length - 1) ? 0 : currentHostIndex + 1;
                    updateHostImage();
                });

                updateHostImage();

                const hostSlideImage = document.getElementById('hostSlideImage');

                // 모든 객실 버튼 선택
                const hostButtons = document.querySelectorAll('#allhotelRoomBtn');

                // 각 객실 버튼에 클릭 이벤트 추가
                hostButtons.forEach((button, index) => {
                    button.addEventListener('click', function () {
                        // 기존 활성화된 버튼이 있으면 원상복구
                        if (activeButton) {
                            const previousDetailBtn = activeButton.querySelector('#detailHostBtn');
                            previousDetailBtn.classList.remove('bg-blue-600', 'text-white');
                            previousDetailBtn.classList.add('bg-white', 'text-gray-700', 'hover:bg-[#e6e6e6]');
                        }

                        // 현재 클릭한 버튼의 detailHostBtn을 활성화 스타일로 변경
                        const detailBtn = button.querySelector('#detailHostBtn');
                        detailBtn.classList.add('bg-blue-600', 'text-white');
                        detailBtn.classList.remove('bg-white', 'text-gray-700');

                        // 클릭된 버튼을 activeButton으로 설정
                        activeButton = button;

                        // 버튼 클릭 로직 (이미지 변경 등)
                        const host = allHostIdx[index]; // 클릭된 버튼의 인덱스를 통해 host 객체 가져오기
                        console.log('Host ID:', host.id); // 클릭된 숙소의 ID 출력

                        // matchedImage에서 해당 host.id에 맞는 이미지 URL 가져오기
                        if (matchImages && matchImages[host.id]) {
                            const imageUrl = `${matchImages[host.id]}`;
                            console.log('Image URL:', imageUrl);

                            // 이미지 업데이트
                            document.getElementById('hostSlideImage').src = imageUrl;
                        } else {
                            console.log(`No image found for host id: ${host.id}`);
                        }
                    });
                });

                let currentRoomIndex = 0;
                
                   // 객실 이미지 업데이트 함수
                function updateRoomImage(filteredImages) {
                    if (filteredImages && filteredImages.length > 0) {
                        const currentImage = filteredImages[currentRoomIndex];
                        if (currentImage.imgName && currentImage.imgName.fname) {
                            const imageUrl = `https://storage.googleapis.com/omastay/room/${currentImage.imgName.fname}`;
                            $('#roomSlideImage').attr('src', imageUrl);
                        } else {
                            console.log("Image at current index is missing imgName or fname.");
                        }
                    } else {
                        console.log("No images available for this room.");
                    }
                }

            // 객실 버튼 클릭 시 이벤트
            const roomButtons = document.querySelectorAll('#allhotelRoomBtn');
            roomButtons.forEach((button, index) => {
                button.addEventListener('click', function() {
                    // 기존 활성화된 버튼 스타일 리셋
                    if (activeButton) {
                        const previousDetailBtn = activeButton.querySelector('#detailRoomBtn');
                        previousDetailBtn.classList.remove('bg-blue-600', 'text-white');
                        previousDetailBtn.classList.add('bg-white', 'text-gray-700', 'hover:bg-[#e6e6e6]');
                    }

                    const detailBtn = button.querySelector('#detailRoomBtn');
                    detailBtn.classList.add('bg-blue-600', 'text-white');
                    detailBtn.classList.remove('bg-white', 'text-gray-700');

                    // 현재 클릭된 버튼 설정
                    activeButton = button;

                    // 클릭된 객실의 room 객체 가져오기
                    const room = allRoomIdx[index]; // 클릭된 객실의 room 객체
                    console.log('Room ID:', room.id); // 클릭된 객실의 ID 출력

                    // roomImages 배열에서 해당 room.id에 맞는 이미지 필터링
                    const filteredImages = roomImages.filter(img => img.rid === room.id);
                    console.log('Filtered Images:', filteredImages);

                    // 초기화하고 첫 번째 이미지 보여주기
                    currentRoomIndex = 0;
                    updateRoomImage(filteredImages);

                    // 이전, 다음 버튼으로 객실 이미지 전환
                    $('#prevRoomImageBtn').off('click').on('click', function () {
                        currentRoomIndex = (currentRoomIndex === 0) ? filteredImages.length - 1 : currentRoomIndex - 1;
                        updateRoomImage(filteredImages);
                    });

                    $('#nextRoomImageBtn').off('click').on('click', function () {
                        currentRoomIndex = (currentRoomIndex === filteredImages.length - 1) ? 0 : currentRoomIndex + 1;
                        updateRoomImage(filteredImages);
                    });
                });
            });

            // 기본적으로 첫 번째 객실 이미지 업데이트 (필요시 제거)
            updateRoomImage([]);

                // 숙소/객실 버튼 설정 로직 (기존 코드에서 업데이트)
                const roomNameBox = document.getElementById('roomNameBox');
                const hostImgBtn = document.getElementById('hostImgBtn');
                const roomImgBtn = document.getElementById('roomImgBtn');

                hostImgBtn.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');

                hostImgBtn.addEventListener('click', function() {
                    roomNameBox.style.display = 'none';
                    roomImgBtn.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                    hostImgBtn.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');

                    roomImgBtn.classList.add('text-gray-500');
                    hostImgBtn.classList.remove('text-gray-500');
                });

                roomImgBtn.addEventListener('click', function() {
                    roomNameBox.style.display = 'flex';
                    hostImgBtn.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                    roomImgBtn.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');

                    hostImgBtn.classList.add('text-gray-500');
                    roomImgBtn.classList.remove('text-gray-500');
                });


                // 호스트 이미지 보기 버튼 클릭
                $('#hostImgBtn').on('click', function () {
                    $('#roomImageBox').addClass('hidden');
                    $('#hostImageBox').removeClass('hidden');
                });

                // 객실 이미지 보기 버튼 클릭
                $('#roomImgBtn').on('click', function () {
                    $('#hostImageBox').addClass('hidden');
                    $('#roomImageBox').removeClass('hidden');
                });
            });

        //호스트 정보 모달창
            
            $(document).ready(function () {
                $('#detailHostBtn').on('click', function () {
                    $('#detailHostModal').removeClass('hidden'); // 모달을 보여줌
                    scrollPosition = $(window).scrollTop();
                    $('body').css({
                        'overflow': 'hidden',
                        'position': 'fixed',
                        'top': `-${scrollPosition}px`,
                        'width': '100%'
                    });
                });

                $('#hostInfoDelBtn, #detailHostModal').on('click', function (event) {
                    if (event.target.id === 'hostInfoDelBtn' || event.target.id === 'detailHostModal') {
                        $('body').css({
                            'overflow': '',
                            'position': '',
                            'top': '',
                            'width': ''
                        });
                        $(window).scrollTop(scrollPosition);
                        $('#detailHostModal').addClass('hidden'); // 모달을 숨김
                    }
                });
            });

            //객실 정보 모달창
            $(document).ready(function () {
                $('.detailRoomInfoBtn').on('click', function () {
                    const roomId = $(this).data('room-id'); 
                    const modalId = `#detailRoomModal_${roomId}`; 

                    // 해당 모달 열기
                    $(modalId).removeClass('hidden');
                    scrollPosition = $(window).scrollTop();
                    $('body').css({
                        'overflow': 'hidden',
                        'position': 'fixed',
                        'top': `-${scrollPosition}px`,
                        'width': '100%'
                    });
                });

                // 모달 닫기 버튼 클릭 시
                $('.roomInfoDelBtn').on('click', function () {
                    const roomId = $(this).data('room-id');
                    const modalId = `#detailRoomModal_${roomId}`;

                    // 해당 모달 닫기
                    $('body').css({
                        'overflow': '',
                        'position': '',
                        'top': '',
                        'width': ''
                    });
                    $(window).scrollTop(scrollPosition);
                    $(modalId).addClass('hidden');
                });
            });

    
            //모달 띄우기, 리뷰 등록
            $(document).ready(function() {
               
                let uploadedFileInfo = [];
                loadReviewList(hIdx);
                $('#reviewInsertBtn').on('click', function() { 
                    if (isLogin === false) {
                        let userConfirmation = confirm("로그인이 필요한 서비스입니다. 로그인 하시겠습니까?"); // 변수명을 다른 것으로 변경
                        if (userConfirmation) {
                            window.location.href = "/login";
                        }
                        return;
                    }
                    initializeRating();
                    uploadedFileInfo=[];
                    scrollPosition = $(window).scrollTop(); 
                    $('body').css({
                        'overflow': 'hidden',         
                        'position': 'fixed',            
                        'top': `-${scrollPosition}px`,   
                        'width': '100%'                 
                    }); 
                    $('#myModal').show();
                 
                    $.ajax({
                        url: '/review_write',
                        method: 'GET',
                        dataType: 'html',
                        success: function(data) {
                            $('#modal-body').html(data);

                            $('#summernote').summernote({
                                lang: 'ko-KR',
                                height: 300,
                                placeholder: '리뷰 내용을 입력하세요',
                                toolbar: [
                                    ['style', ['style']],
                                    ['font', ['bold', 'underline', 'italic', 'clear']],
                                    ['color', ['color']],
                                    ['para', ['ul', 'ol', 'paragraph']],
                                    ['table', ['table']],
                                    ['insert', ['link', 'picture', 'video']],
                                    ['view', ['fullscreen', 'codeview', 'help']]
                                ],
                                callbacks: {
                                    onImageUpload: function(files) {
                                        for (let i = 0; i < files.length; i++){
                                            uploadImage(files[i]);
                                        }
                                    }
                                }
                            });

                            function uploadImage(file) {
                                let formData = new FormData();
                                formData.append('file', file);
                                $.ajax({
                                    url: "/upload_image",
                                    type: "POST",
                                    data: formData,
                                    contentType: false,
                                    processData: false, 
                                    dataType: "json",
                                }).done(function(data){
                                    const imageUrl = data.url;
                                    const imgTag = '<img src="' + imageUrl + '" alt="Image">';
                                    $('.note-editable').append(imgTag);
                                    console.log("데이터"+JSON.stringify(data));
                                    
                                    uploadedFileInfo.push({
                                        oname: data.oname,
                                        fname: data.fname
                                    });
                                });
                            }
                            
                            // Insert button click event
                            $('#insertBtn').on('click', function() {
                                const rating = currentRating;
                                const contentHtml = $('.note-editable').html();
                                const tempDiv = document.createElement('div');
                                tempDiv.innerHTML = contentHtml;
                                
                                let textContent = '';
                                tempDiv.querySelectorAll('p').forEach(p => {
                                    textContent += p.textContent + '\n';
                                });
                                const content = textContent.trim();

                                let formData = new FormData();
                                formData.append('revContent', content);
                                formData.append('revRating', rating);
                                formData.append('memIdx', user.id);
                                formData.append('hIdx',hIdx);

                                uploadedFileInfo.forEach((fileInfo, index) => {
                                    formData.append('oname_' + index, fileInfo.oname); 
                                    formData.append('fname_' + index, fileInfo.fname);
                                });
                                console.log("이야"+JSON.stringify(formData));

                                $.ajax({
                                    url: '/review_insert',
                                    method: 'POST',
                                    data: formData,
                                    contentType: false,
                                    processData: false,
                                    success: function(data) {
                                        console.log("응답"+data);
                                        if(data === 1){
                                            alert('리뷰가 성공적으로 등록되었습니다.');
                                        }else if(data === 0){
                                            alert('호텔 예약 내역이 없는 회원입니다.');
                                        }else{
                                            alert('리뷰 작성 중 오류가 발생했습니다.')
                                        }
                                        
                                        loadReviewList(hIdx);
                                        $('body').css({
                                        'overflow': '',                   
                                        'position': '',                   
                                        'top': '',                        
                                        'width': ''                       
                                    });
                                    $(window).scrollTop(scrollPosition);  
                                    $('#myModal').hide();
                                  
                                    },
                                    error: function(xhr, status, error) {
                                        alert('리뷰 등록에 실패했습니다. 잠시 후 다시 시도해주세요.');
                                    }
                                });
                            });

                            $('#closeBtn, #myModal').on('click', function(event) {
                                if (event.target.id === 'closeBtn' || event.target.id === 'myModal') {
                                    $('body').css({
                                        'overflow': '',                   
                                        'position': '',                   
                                        'top': '',                      
                                        'width': ''                       
                                    });
                                    $(window).scrollTop(scrollPosition); 
                                    $('#myModal').hide();
                                }
                            });


                        },
                        error: function(xhr, status, error) {
                            alert('리뷰 작성 페이지를 불러오는 데 실패했습니다.');
                        }
                    });
                });
            });



            let reviewCounts = [];
            let reservationCounts = [];
            let sortOption = "최신순";
            let reviewList = [];

            function calculateReviewCounts(reviewList) {
                const reviewCounts = {};
                    for (const reviewData of reviewList) {
                        const memIdx = reviewData.review.memIdx;
                        reviewCounts[memIdx] = (reviewCounts[memIdx] || 0) + 1;
                    }
                    console.log("개수"+JSON.stringify(reviewCounts));
                    return Object.entries(reviewCounts).map(([memIdx, count]) => ({ memIdx, count }));
                    }

            function calculateResCounts(reviewList){
                const reservationCounts ={};
                    for(const reviewData of reviewList) {
                        const memIdx = reviewData.reservation.memIdx;
                        reservationCounts[memIdx] = (reservationCounts[memIdx] || 0) + 1;
                    }
                    console.log("호호"+JSON.stringify(reservationCounts));
                    return Object.entries(reservationCounts).map(([memIdx, count]) => ({ memIdx, count }));
            }


          
            //리뷰 리스트 불러오기
            function loadReviewList(hIdx) {
               
                $.ajax({
                    url: '/review_list',  
                    method: 'GET',
                    data: { 
                            sort: sortOption,
                            hIdx: hIdx 
                        },
                    dataType: 'json',
                    success: function(response) { // responseList -> response
                        // 기존 리뷰 목록 컨테이너 비우기
                        $('#reviewListContainer').empty(); 
                        console.log("하하호호"+JSON.stringify(response));
                        reviewList = response.reviewList;
                        reviewCounts = calculateReviewCounts(response.reviewList); // reviewCounts 계산
                        reservationCounts = calculateResCounts(response.reviewList);

                        // 새로운 리뷰 목록 생성 및 추가
                        
                        for (const reviewData of response.reviewList) { 
                        const reviewHtml = generateReviewHtml(reviewData, reviewCounts,reservationCounts);  // reviewCounts 계산 후에 호출
                        $('#reviewListContainer').append(reviewHtml);
                        }
                                                                
                    },
                    error: function(xhr, status, error) {
                        alert('리뷰 목록을 가져오는 데 실패했습니다. 잠시 후 다시 시도해주세요.');
                    }
                });
            
            }
          
            loadReviewList(hIdx); 

        


            //추천순,최신순,평점순 정렬기능
            document.addEventListener('click', (event) => {
                const recommDropBtns = event.target.closest('.dropdown-item');
                if (recommDropBtns) {
                    const recommSpan = document.getElementById('recommSpan');
                    recommSpan.innerText = event.target.innerText;

                    let sortOption = event.target.innerText; 

                    if (sortOption === "추천순") {
                        reviewList.sort(sortByRecommendation);
                    } else if (sortOption === "최신순") {
                        reviewList.sort(sortByDate);
                    } else if (sortOption === "평점 높은 순") {
                        reviewList.sort(sortByRatingDesc);
                    } else if (sortOption === "평점 낮은 순") {
                        reviewList.sort(sortByRatingAsc);
                    }
                    $('#reviewListContainer').empty(); 
    
                    for (const reviewData of reviewList) { 
                        console.log("이러면 되냐~"+reviewList);
                        const reviewHtml = generateReviewHtml(reviewData, reviewCounts,reservationCounts);  // reviewCounts 계산 후에 호출
                        $('#reviewListContainer').append(reviewHtml);
                    }
                }
            });
            
                //추천순
                function sortByRecommendation(a, b) {
                    return new Date(b.review.revDate) - new Date(a.review.revDate); 
                }
                //최신순
                function sortByDate(a, b) {
                    return new Date(b.review.revDate) - new Date(a.review.revDate);
                }
                //평점 높은순
                function sortByRatingDesc(a, b) {
                    return b.review.revRating - a.review.revRating;
                }
                //평점 낮은순
                function sortByRatingAsc(a, b) {
                    return a.review.revRating - b.review.revRating;
                }


            //별점 초기화 기능
            function initializeRating() {
                        if (isRatingInitialized) {
                        return; // 이미 별점이 초기화되었으면 다시 초기화하지 않음
                    }

                ratingContainers = document.querySelectorAll('#rating-container');
                currentRating = 0;

                ratingContainers.forEach(ratingContainer => {
                    const stars = [];
                    const svgNS = "http://www.w3.org/2000/svg";

                    for (let i = 0; i < 5; i++) {
                        const star = document.createElementNS(svgNS, 'svg');
                        star.setAttributeNS(null, 'width', '50');
                        star.setAttributeNS(null, 'height', '50');
                        star.setAttributeNS(null, 'fill', 'gold');
                        star.setAttributeNS(null, 'class', 'bi bi-star');
                        star.setAttributeNS(null, 'viewBox', '0 0 16 16');

                        const path = document.createElementNS(svgNS, 'path');
                        path.setAttributeNS(null, 'd', "M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z");
                        star.appendChild(path);
                        star.classList.add('star');
                        star.dataset.index = i;
                        stars.push(star);
                        ratingContainer.appendChild(star);

                        // 클릭 이벤트 리스너 추가
                        star.addEventListener('click', (e) => {
                            const boundingRect = star.getBoundingClientRect();
                            const clickX = e.clientX - boundingRect.left;

                            if (clickX <= boundingRect.width / 2) {
                                currentRating = i + 0.5; // 절반 채움
                            } else {
                                currentRating = i + 1; // 전부 채움
                            }
                            updateStar();
                        });
                    }

                    // 마우스가 별점을 벗어날 때 이벤트 리스너 추가
                    ratingContainer.addEventListener('mouseleave', () => {
                        updateStar();
                    });

                    // 별 업데이트 함수 정의
                    function updateStar(rating = currentRating) {
                        for (let i = 0; i < 5; i++) {
                            const star = stars[i];
                            if (rating >= i + 1) {
                                star.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="gold" class="bi bi-star-fill" viewBox="0 0 16 16">
                                    <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                                </svg>`;
                            } else if (rating > i && rating < i + 1) {
                                star.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="gold" class="bi bi-star-half" viewBox="0 0 16 16">
                                    <path d="M5.354 5.119 7.538.792A.52.52 0 0 1 8 .5c.183 0 .366.097.465.292l2.184 4.327 4.898.696A.54.54 0 0 1 16 6.32a.55.55 0 0 1-.17.445l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256a.5.5 0 0 1-.146.05c-.342.06-.668-.254-.6-.642"/>
                                </svg>`;
                            } else {
                                star.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="gold" class="bi bi-star" viewBox="0 0 16 16">
                                    <path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"/>
                                </svg>`;
                            }
                        }
                    }
                });
                isRatingInitialized = true; 

            }


                $(document).on('click', '.note-btn', function() {
                    // 모달이 생성되기 전에 미리 백드롭을 제거
                    $('.note-modal-backdrop').remove();
                    
                });


                $(document).ready(function() {
                    // 이벤트 위임을 사용하여 동적으로 추가된 버튼에도 적용되도록 설정
                    $(document).on('click', '#toggleButton', function() {
                        var reviewText = $('#reviewText');
                        
                        // 전체 높이를 동적으로 계산
                        var fullHeight = reviewText.prop('scrollHeight') + "px";
                        
                        // 현재 상태 확인
                        if (reviewText.hasClass('max-h-[60px]')) {
                            reviewText.removeClass('max-h-[60px]').css('max-height', fullHeight);  // 전체 높이로 확장
                            $(this).text('접기');
                        } else {
                            reviewText.addClass('max-h-[60px]').css('max-height', '60px');  // 다시 60px로 축소
                            $(this).text('더보기');
                        }
                    });

                    // 페이지 로드 시 'collapsed' 상태가 제대로 적용되었는지 확인
                    $('#reviewText').css('max-height', '60px');
                });
            
            function generateImageTags(reviewImage) {
                console.log(reviewImage);
                let imageTags = '';
                if (reviewImage && reviewImage.length > 0) {
                    for (let i = 0; i < reviewImage.length; i++) {
                        if (reviewImage[i]) {
                            imageTags += `<img src="${reviewImage[i]}" alt="Review Image" class="h-[120px] w-[160px] object-cover rounded-lg">`;
                        }
                    }
                }
                return imageTags;
            }

        //리뷰 생성     
        function generateReviewHtml(reviewData,reviewCounts,reservationCounts) {
            const review = reviewData.review;
            const member = reviewData.member;
            const room = reviewData.room;
            const grade = reviewData.grade;
            const hostinfo = reviewData.hostinfo;
            const reviewComment = reviewData.reviewComment; 
            const timeDetail = calculateTime(reviewData); // reviewData 전달
            const memIdx = reviewData.review.memIdx;
            const reviewImage = reviewData.reviewImages;

            // 리뷰 개수 계산
            let reviewCount = 0;
                for (let i = 0; i < reviewCounts.length; i++) {
                    if (Number(reviewCounts[i].memIdx) === memIdx) { 
                    reviewCount = reviewCounts[i].count;
                    break;
                    }
                }
            
            let reservationCount = 0;
                for (let i = 0; i < reservationCounts.length; i++) {
                    if (Number(reservationCounts[i].memIdx) === memIdx) { 
                    reservationCount = reservationCounts[i].count;
                    break;
                    }
                }
                        
                let commentHtml = '';
                let reviewCommentBoxHtml = ''; // 리뷰 댓글이 있는 경우에만 사용되는 HTML 변수

                // 댓글이 있는 경우에만 commentHtml과 reviewCommentBoxHtml을 생성
                if (reviewData.reviewComment && reviewData.reviewComment.length > 0) {
                    for (const comment of reviewData.reviewComment) {
                        commentHtml += `<p class="text-sm text-gray-900">${comment.rcComment}</p>`; 
                    }

                    reviewCommentBoxHtml = `
                        <div id="reviewCommentBox">
                            <div class="p-4 bg-gray-100 rounded-lg w-[890px] h-[200px]">
                                <p class="text-sm font-bold text-gray-900">
                                    ${hostinfo.hname}
                                </p>
                                ${commentHtml} 
                            </div>
                        </div>
                    `;
                }

                // 유저 등급에 따라 이미지 경로 설정
                let gradeImagePath = '/image/detail/방랑자.png'; // 기본: 방랑자 등급 이미지
                if (grade.gcate === '탐험가') {
                    gradeImagePath = '/image/detail/탐험가.png'; // 탐험가 등급 이미지
                } else if (grade.gcate === '개척자') {
                    gradeImagePath = '/image/detail/개척자.png'; // 개척자 등급 이미지
                }

                // 조건에 맞게 삭제 버튼을 추가
                const deleteButtonHtml = (isLogin===true&&user.id === review.memIdx) ? `
                    <button id="deleteReviewBtn" data-rev-idx="${review.id}" class="text-red-600 text-sm font-semibold ml-2">
                        삭제
                    </button>
                ` : '';

                // 메인 HTML 생성
                return `
                    <div class="flex-1 flex flex-row items-start justify-start flex-wrap content-start gap-[72px] max-w-full">
                        <!-- 유저 정보 -->
                        <div class="flex flex-row items-end justify-start gap-[12px]">
                            <img alt="" class="h-[45px] w-[45px] relative rounded-full object-cover shadow-md" src="${gradeImagePath}" />
                            <div class="flex flex-col items-start justify-end pt-[0px] px-[0px] pb-[2.3px]">
                                <div class="flex flex-col items-start justify-start gap-[8px]">
                                    <div class="rounded-[3px] bg-[#f5f7fa] flex flex-row items-center justify-start py-[5px] pl-[10px] pr-[10px] shrink-0 text-sm">
                                        <b class="relative inline-block min-w-[34px] text-gray-700">${grade.gcate}</b>
                                    </div>
                                    <div class="flex flex-row items-start justify-start py-[0px] text-gray-500">
                                        <div class="flex flex-col items-start justify-start">
                                            <div class="relative font-semibold text-lg text-gray-800">${member.memName}</div>
                                            <div class="relative text-sm">
                                                리뷰 ${reviewCount} · 다녀온 장소 ${reservationCount}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 리뷰 본문 -->
                        <div class="flex-1 flex flex-col items-start justify-start gap-[42px] min-w-[580px] max-w-full text-gray-600 mq750:min-w-full">
                            <div class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[1px] pr-[0px] box-border max-w-full">
                                <div class="flex-1 flex flex-col items-start justify-start gap-[14px] max-w-full">
                                    <div class="flex flex-row items-center gap-[5px] text-gray-500">
                                        <img alt="" class="h-[15px] w-[15px]" src="/image/detail/star1.svg" />
                                        <span class="text-lg font-semibold text-gray-800">${review.revRating}/5</span>
                                        <span class="relative text-sm text-gray-400">${timeDetail}</span>
                                    </div>
                                    
                                    <!-- 이미지 리스트 -->
                                    <div class="w-full overflow-x-auto flex flex-row items-start justify-start gap-[16px] max-w-full">
                                        ${generateImageTags(reviewImage)}
                                    </div>

                                    <!-- 리뷰 텍스트 -->
                                    <div class="self-stretch flex flex-col items-start justify-start gap-[14px] text-[13.9px] text-gray-800">
                                        <p class="font-semibold text-lg">${room.roomName}</p>
                                        <span id="reviewText" class="overflow-hidden transition-all duration-300 max-h-[60px]">
                                            ${review.revContent}
                                        </span>
                                        <button id="toggleButton" class="relative font-semibold text-blue-500 text-sm">
                                            더보기
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 추천/삭제 버튼 -->
                            <div class="flex flex-row items-center justify-start gap-[12px] text-sm text-gray-600">
                                <button id="goodBtn" data-rev-idx="${review.id}" class="flex items-center gap-[6px] px-[12px] py-[8px] bg-blue-50 rounded-lg hover:bg-blue-100 transition shadow-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hand-thumbs-up-fill text-blue-500" viewBox="0 0 16 16">
                                        <path d="M6.956 1.745C7.021.81 7.908.087 8.864.325l.261.066c.463.116.874.456 1.012.965.22.816.533 2.511.062 4.51a10 10 0 0 1 .443-.051c.713-.065 1.669-.072 2.516.21.518.173.994.681 1.2 1.273.184.532.16 1.162-.234 1.733q.086.18.138.363c.077.27.113.567.113.856s-.036.586-.113.856c-.039.135-.09.273-.16.404.169.387.107.819-.003 1.148a3.2 3.2 0 0 1-.488.901c.054.152.076.312.076.465 0 .305-.089.625-.253.912C13.1 15.522 12.437 16 11.5 16H8c-.605 0-1.07-.081-1.466-.218a4.8 4.8 0 0 1-.97-.484l-.048-.03c-.504-.307-.999-.609-2.068-.722C2.682 14.464 2 13.846 2 13V9c0-.85.685-1.432 1.357-1.615.849-.232 1.574-.787 2.132-1.41.56-.627.914-1.28 1.039-1.639.199-.575.356-1.539.428-2.59z"/>
                                    </svg>
                                    <span class="font-semibold text-blue-600">추천</span>
                                </button>
                                ${deleteButtonHtml}
                            </div>

                            ${reviewCommentBoxHtml}
                        </div>
                        <div class="self-stretch h-[1px] bg-gray-300 w-full"></div>
                    </div>
                `;
                        }

        document.addEventListener('click', (event) => {
            const deleteReviewBtn = event.target.closest('#deleteReviewBtn');
            if (deleteReviewBtn) {
                const revIdx = deleteReviewBtn.dataset.revIdx;
                if (confirm('정말로 이 리뷰를 삭제하시겠습니까?')) {
                    $.ajax({
                        url: '/review_delete', // 리뷰 삭제 엔드포인트
                        method: 'POST',
                        data: {
                            revIdx: revIdx
                        },
                        success: function() {
                            alert('리뷰가 성공적으로 삭제되었습니다.');
                            loadReviewList(hIdx); // 리뷰 리스트 다시 불러오기
                        },
                        error: function(xhr, status, error) {
                            alert('리뷰 삭제에 실패했습니다. 잠시 후 다시 시도해주세요.');
                        }
                    });
                }
            }
        });


        document.addEventListener('click', (event) => {
                const goodBtn = event.target.closest('#goodBtn');
                if (goodBtn) {
                    if (isLogin === false) {
                        let userConfirmation = confirm("로그인이 필요한 서비스입니다. 로그인 하시겠습니까?"); // 변수명을 다른 것으로 변경
                        if (userConfirmation) {
                            window.location.href = "/login";
                        }
                        return;
                    }
                    const revIdx = goodBtn.dataset.revIdx;
                    console.log(revIdx);
                    $.ajax({
                        url: '/good_insert',
                        method: 'POST',
                        data: {revIdx : revIdx,
                            memIdx : user.id
                        },
                        success: function(result) {
                            const newGoodIdx = result.newGoodIdx;
                            const goodStatus = result.goodStatus;
                            console.log(result);
                            const icon = goodBtn.querySelector('.bi-hand-thumbs-up-fill'); 
                            if(goodStatus === 'TRUE') {
                                icon.style.color = 'gold';
                            } else {
                                icon.style.color = 'currentColor';
                            }
                        },
                        error: function(xhr, status, error) {
                            alert('추천안됨');                                                                                                                 
                        }
                    });
                    
                }

            });

            function reservationBtnClick(buttonElement){
                const room = buttonElement.getAttribute('data-room');
                const price = totalPrices[room]; // room (roomIdx)로 totalPrices 객체에서 총 가격 가져옴
                console.log('객실 총액:', price);

                const checkInDate = new Date(sessionStorage.getItem('startDate'));
                const checkOutDate = new Date(sessionStorage.getItem('endDate'));

                // ISO 8601 형식으로 변환
                const formattedCheckIn = checkInDate.toISOString();  
                const formattedCheckOut = checkOutDate.toISOString();
                window.location.href = `/reservation?room=${encodeURIComponent(room)}&checkIn=${encodeURIComponent(formattedCheckIn)}&checkOut=${encodeURIComponent(formattedCheckOut)}&person=${encodeURIComponent(sessionStorage.getItem('people'))}&amount=${price}`;

            }

    

            function calculateTime(reviewData) {
                const revDate = new Date(reviewData.review.revDate); // reviewData에서 revDate 가져오기
                const currentDate = new Date();
                const timeDifference = currentDate - revDate;

                const seconds = Math.floor(timeDifference / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24   
                );
                const months = Math.floor(days / 30);
                const years = Math.floor(months / 12);

                if (seconds < 60) {
                    return '방금 전';
                } else if (minutes < 60) {
                    return `${minutes}분 전`;
                } else if (hours < 24) {
                    return `${hours}시간 전`;
                } else if (days < 30) {
                    return `${days}일 전`;
                } else if (months < 12) {
                    return `${months}달 전`;
                } else {
                    return `${years}년 전   
                `;
                }
                }
                
           

</script>
</body>
<script>
    $(document).ready(function () {
        //세션스토리지의 값 searh_bar에 넣기
        let s_count = sessionStorage.getItem('count');
        if (s_count) {
            $("#person_count2").val(s_count);
        }
    });
</script>
</html>
