<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/admin}" layout:fragment="admin">

<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="https://cdn.datatables.net/2.1.5/css/dataTables.dataTables.css" />
</head>

<body>
  <div
    class="w-full relative rounded-[30px] bg-[#f5f6fb] overflow-hidden shrink-0 flex flex-col items-start justify-start pt-[30px] px-[20px] pb-[50px] box-border gap-[20px] leading-[normal] tracking-[normal] text-center text-[24px] text-[#000]">

    <!-- 제목 영역-->
    <label
      class="m-[0px] self-stretch h-[40px] relative text-inherit font-semibold font-[inherit] flex items-center shrink-0 mq450:text-[19px]">
      회원 조회</label>
    <button id="openModal">[임시]</button>
    <!-- 테이블 영역-->

    <div th:if="${list == null}"
      class="w-[1300px] rounded-[30px] bg-[#eaecf8] oflex flex-col items-start justify-start p-[20px] box-border gap-[10px] max-w-full text-left text-[16px] text-[#000]">
      <p class="text-[18px] text-[#6c757d]">등록된 회원 정보가 없습니다.</p>
    </div>

    <div th:if="${list != null}"
      class="w-[1300px] rounded-[30px] bg-[#eaecf8] oflex flex-col items-start justify-start p-[20px] box-border gap-[10px] max-w-full text-left text-[16px] text-[#000]">

      <!-- 테이블 데이터 영역-->
      <div id="table" class="pt-[10px] px-[10px] pb-[10px] gap-[10px] m-auto">
        <table id="listTable" class="w-[1200px] hover ">
          <thead>
            <tr class="bg-[#d4d8f1] font-medium">
              <th>회원 번호</th>
              <th>등급</th>
              <th>이메일</th>
              <th>연락처</th>
              <th>이름</th>
              <th>가입일</th>
            </tr>
          </thead>
          <tbody class="bg-[#ffffff] pt-[100px] ">
            <tr th:each="mem : ${list}">
              <td th:text="${mem.id}"></td>
              <td th:text="${mem.gIdx}"></td>
              <td th:text="${mem.memberProfile.email}"></td>
              <td th:text="${mem.memPhone}"></td>
              <td th:text="${mem.memName}"></td>
              <td th:text="${#temporals.format(mem.memJoinDate, 'yyyy-MM-dd HH:mm')}"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- 회원 상세보기 모달 -->
    <div id="modalOverlay"
    class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 justify-center items-center z-50 hidden text-[14px]">
    <div
      class="w-[615px] rounded-[50px] bg-[#e2e3f5] overflow-hidden shrink-0 flex flex-col items-center justify-center p-[30px]">
      
      <div
        class="w-full rounded-[20px] bg-[#fff] overflow-hidden shrink-0 flex flex-col items-start justify-start py-[10px] px-[30px] gap-[15px] ">
        <button id="closeModal" class="w-full items-end justify-end flex">
          <img class="h-6 w-6" alt="" src="/image/admin/icon-cancel.png" />
        </button>
        <div class="w-full h-[50px] flex flex-row items-center justify-center gap-3">
          <img class="h-[50px] w-[50px] rounded-[100px] border-yellow-300 object-cover shrink-0" alt=""
            src="/image/admin/개척자.png" />
          <label class="text-[24px]">홍길동</label>
        </div>
        
        <label class="">
          회원 등급
        </label>
        <div class="flex flex-row justify-center items-center gap-2 w-full">
          <input type="radio" name="grade" value="1"/> <label>방랑자</label>
          <input type="radio" name="grade" value="1"/> <label>탐험가</label>
          <input type="radio" name="grade" value="1"/> <label>개척자</label>
        </div>
          
        <label class="">
          실명
        </label>
        <input
          class="w-full [border:none] [outline:none] bg-[transparent] self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
          placeholder="실명" type="text" />

        <label class="">아이디</label>
        <input
              class="w-full [border:none] [outline:none] bg-[transparent] self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
              placeholder="아이디" type="text" />
        
        <label class="">이메일</label>
        <input
              class="w-full [border:none] [outline:none] bg-[transparent] self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
              placeholder="이메일" type="text" />
        
        <div class="">가입일</div>
        <input
              class="w-full [border:none] [outline:none] bg-[transparent] self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
              placeholder="가입일" type="text" />

        <div class="">예약내역</div>
        <div class="flex flex-row w-full"> 
          <div class="w-1/2 py-[10px] border-solid border-[1px] border-[#a4a4a4] rounded-l-[20px] flex flex-col items-center justify-center">
            <div>최근 3개월 내 예약 건수</div> 
            <div>n 건</div>
          </div> 
          <div class="w-1/2 py-[10px] border-solid border-[1px] border-[#a4a4a4] rounded-r-[20px] flex flex-col items-center justify-center"> 
            <div>전체 예약 건수</div> 
            <div>n 건</div>
          </div>
        </div>
        
        <div class="">최근 예약 내역</div>
        <div class="w-full">
          <table class="w-full">
            <thead>
              <tr>
                <th>예약번호</th>
                <th>숙소명</th>
                <th>체크인</th>
                <th>체크아웃</th>
                <th>예약일</th>
                <th>예약상태</th>
              </tr>
            </thead>
            <tbody>
              
              <tr>
                <td>1</td>
                <td>숙소명</td>
                <td>체크인</td>
                <td>체크아웃</td>
                <td>예약일</td>
                <td>예약상태</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  </div>
  <!-- 모달 끝 -->

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/2.1.5/js/dataTables.js"></script>
  <script>
    $(document).ready(function () {
      $("#listTable").DataTable();

      // 테이블 행 클릭 이벤트
      $('#listTable tbody').on('click', 'tr', function () {
        var memberId = $(this).data('id');
        fetchMemberDetails(memberId);
      });

      $("#openModal").click(function () {
        $("#modalOverlay").css("display", "flex");
      });

      $("#closeModal").click(function () {
        $("#modalOverlay").css("display", "none");
      });
    });

    // 회원 상세 정보 가져오기
    function fetchMemberDetails(memberId) {
      // 예시 API 호출
      fetch(`/api/members/${memberId}`)
        .then(response => response.json())
        .then(data => {
          // 모달 내용 업데이트
          $('#modalContent').html(`
            <img class="h-[50px] w-[50px] rounded-[100px] border-yellow-300 object-cover shrink-0" alt=""
              src="${data.image}" />
            <label class="text-[24px]">${data.name}</label>
            <label class="">회원 등급</label>
            <div class="flex flex-row justify-center items-center gap-2 w-full">
              <input type="radio" name="grade" value="1" ${data.grade === '방랑자' ? 'checked' : ''}/> <label>방랑자</label>
              <input type="radio" name="grade" value="2" ${data.grade === '탐험가' ? 'checked' : ''}/> <label>탐험가</label>
              <input type="radio" name="grade" value="3" ${data.grade === '개척자' ? 'checked' : ''}/> <label>개척자</label>
            </div>
            <label class="">실명</label>
            <input class="w-full border-none outline-none bg-transparent self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
              placeholder="실명" type="text" value="${data.realName}" />
            <label class="">아이디</label>
            <input class="w-full border-none outline-none bg-transparent self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
              placeholder="아이디" type="text" value="${data.username}" />
            <label class="">이메일</label>
            <input class="w-full border-none outline-none bg-transparent self-stretch h-[24px] flex flex-row items-center justify-start font-[Roboto] text-[16px] text-[rgba(0,0,0,0.6)] min-w-[187px]"
              placeholder="이메일" type="text" value="${data.email}" />
          `);
          // 모달 표시
          $("#modalOverlay").css("display", "flex");
        })
        .catch(error => {
          console.error('Error fetching member details:', error);
        });
    }
  </script>
</body>

</html>