<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/host}"
      layout:fragment="host">
  <head>
    <meta charset="utf-8" />
    <style>
      textarea:focus {
        outline: none;
        /* 포커스 시 기본 아웃라인 제거 */
        border-color: rgba(0, 0, 0, 0.23);
        box-shadow: none;
        /* 포커스 시 그림자 제거 */
      }

      textarea {
      resize: none;
      /* 창 크기 조절 핸들 제거 */
    }
    </style>
  </head>
  <body>
    <div
      class="w-full relative bg-[#e4e7eb] flex flex-row items-start justify-center py-[100px] pl-[21px] pr-[20px] box-border leading-[normal] tracking-[normal]"
    >
      <main
        class="pt-[20px] pb-[20px] w-[1200px] rounded-[30px] bg-[#fff] flex flex-col items-start justify-start gap-[20px] max-w-full"
      >
        <section
          class="self-stretch flex flex-row items-start justify-start py-[0px] pl-[1px] pr-[0px] box-border max-w-full text-left text-[50px] text-[#000] font-[Roboto]"
        >
          <div
            class="flex-1 flex flex-row items-center justify-between py-[50px] px-[94px] box-border max-w-full gap-[20px] lg:pl-[47px] lg:pr-[47px] lg:box-border mq750:flex-wrap mq750:pl-[23px] mq750:pr-[23px] mq750:box-border"
          >
            <h1
              class="mx-[55px] m-[0px] h-[50px] w-[233px] relative text-inherit tracking-[0.15px] leading-[24px] font-bold font-[inherit] flex items-center shrink-0 mq1050:text-[40px] mq1050:leading-[19px] mq450:text-[30px] mq450:leading-[14px]"
            >
              리뷰 상세
            </h1>
            <button type="button" onclick="location.href='/host/review'"
              class="mr-[55px] cursor-pointer [border:none] py-[8px] px-[22px] bg-[#2196f3] rounded-[4px] overflow-hidden flex flex-col items-center justify-center"
            >
              <div class="flex flex-row items-center justify-center gap-[8px]">
                <b
                  class="relative text-[15px] tracking-[0.46px] leading-[26px] uppercase inline-block font-[Roboto] text-[#fff] text-left min-w-[57px]"
                  >목록보기</b
                >
              </div>
            </button>
          </div>
        </section>
        <section
          class="self-stretch flex flex-row items-start justify-center py-[0px] pl-[0px] pr-[1px] box-border max-w-full text-left text-[20px] text-[#000] font-[Roboto]"
        >
          <div
            class="w-[1000px] flex flex-col items-start justify-start gap-[20px] max-w-full"
          >
            <div
              class="self-stretch relative tracking-[0.46px] leading-[20px] uppercase font-medium mq450:text-[16px] mq450:leading-[16px]"
            >
              사용자 리뷰
            </div>
            <div
              class="self-stretch rounded-[30px] bg-[rgba(200,219,245,0.52)] overflow-hidden flex flex-col items-start justify-start py-[17px] pl-[138px] pr-[136px] box-border gap-[10px] max-w-full text-[12px] text-[rgba(0,0,0,0.6)] lg:pl-[69px] lg:pr-[68px] lg:box-border mq750:pl-[34px] mq750:pr-[34px] mq750:box-border"
            >
              <div
                class="w-[500px] flex flex-row gap-[10px] items-start justify-start min-w-[24px] min-h-[24px] max-w-full text-[16px] text-[rgba(0,0,0,0.87)]"
              >
                <div>
                  작성자  : 
                </div>
                <div class="flex flex-col items-start justify-start gap-[2px]">
                <div
                  class="flex-1 relative tracking-[0.15px] leading-[24px] inline-block max-w-full"
                  th:text="${review.revWriter}"
                >
                </div>
                <div
                  class="w-[200px] h-[2px] relative border-[#000] border-t-[2px] border-solid box-border max-w-full"
                ></div>
                </div>
              </div>
              <div
                class="w-[500px] flex flex-row gap-[10px] items-start justify-start min-w-[24px] min-h-[24px] max-w-full text-[16px] text-[rgba(0,0,0,0.87)]"
              >
                <div>
                  평점  : 
                </div>
                <div class="flex flex-col items-start justify-start gap-[2px]">
                <div
                  class="flex-1 relative tracking-[0.15px] leading-[24px] inline-block max-w-full"
                  th:text="${review.revRating}"
                >
                </div>
                <div
                  class="w-[200px] h-[2px] relative border-[#000] border-t-[2px] border-solid box-border max-w-full"
                ></div>
                </div>
              </div>
              <div class="w-[500px] flex flex-row gap-[10px] items-start justify-start min-w-[24px] min-h-[24px] max-w-full text-[16px] text-[rgba(0,0,0,0.87)]">
                첨부파일 : 
                <div class="flex flex-col items-start justify-start gap-[2px]">
              <div>
                <div th:if="${review.revFileImageNameVo != null}">
                  <a th:href="|javascript:down('${review.revFileImageNameVo.fName}')|">
                      <span th:text="${review.revFileImageNameVo.fName}"></span>
                  </a>
              </div>
              <div th:if="${review.revFileImageNameVo == null}">
                  <span>첨부된 파일이 없습니다.</span>
              </div>
              </div>
              <div
                  class="w-[250px] h-[2px] relative border-[#000] border-t-[2px] border-solid box-border max-w-full"
                ></div>
            </div>
              </div>
              <div
                class="self-stretch flex flex-row items-start justify-start flex-wrap content-start max-w-full [row-gap:20px]"
              >
                <div
                  class="flex-1 flex flex-col items-start justify-start relative max-w-full mq1050:min-w-full"
                >
                  <div
                    class="self-stretch rounded-[4px] border-[rgba(0,0,0,0.23)] border-[1px] border-solid box-border flex flex-col items-start justify-start py-[0px] px-[11px] max-w-full text-[16px] text-[rgba(0,0,0,0.87)]"
                  >
                    <div
                      class="self-stretch overflow-hidden flex flex-row items-center justify-start py-[16px] px-[0px] box-border min-w-[24px] min-h-[24px] max-w-full"
                    >
                      <div
                        class="h-[188px] flex-1 relative tracking-[0.15px] leading-[24px] inline-block max-w-full"
                        th:text="${review.revContent}"
                      >
                        내용
                      </div>
                    </div>
                  </div>
                  <div
                    class="h-[2px] !m-[0] absolute top-[0px] left-[12px] bg-[#fff] flex flex-row items-center justify-start py-[0px] px-[3px] box-border z-[1]"
                  >
                    <div
                      class="relative tracking-[0.15px] leading-[12px] inline-block min-w-[25px]"
                    >
                      내용
                    </div>
                  </div>
                </div>
              </div>
              
            </div>
            <div
              class="self-stretch relative tracking-[0.46px] leading-[20px] uppercase font-medium mq450:text-[16px] mq450:leading-[16px]"
            >
              리뷰 답변
            </div>
            <div
              class="self-stretch rounded-[30px] bg-[#e2ecf9] overflow-hidden flex flex-col items-start justify-start py-[32px] pl-[138px] pr-[136px] box-border gap-[38px] max-w-full text-[12px] text-[rgba(0,0,0,0.6)] lg:pl-[69px] lg:pr-[68px] lg:box-border mq750:gap-[19px] mq750:pl-[34px] mq750:pr-[34px] mq750:box-border mq450:pt-[21px] mq450:pb-[21px] mq450:box-border"
            >
              <div
                class="self-stretch flex flex-row items-start justify-start max-w-full [row-gap:20px] mq1050:flex-wrap"
              >
                <div
                  class="flex-1 flex flex-col items-start justify-start relative max-w-full mq1050:min-w-full"
                >
                  <div
                    class="self-stretch rounded-[4px] border-[rgba(0,0,0,0.23)] border-[1px] border-solid box-border flex flex-col items-start justify-start py-[0px] px-[11px] max-w-full text-[16px] text-[rgba(0,0,0,0.87)]"
                  >
                    <div
                      class="self-stretch overflow-hidden flex flex-row items-center justify-start py-[16px] px-[0px] box-border min-w-[24px] min-h-[24px] max-w-full"
                    >
                    <textarea
                    class="revComment bg-[#e2ecf9] h-[188px] flex-1 relative tracking-[0.15px] leading-[24px] inline-block max-w-full"
                    th:if="${reviewCommentDTO != null}"
                    th:text="${reviewCommentDTO.rcComment}"
                    th:attr="readonly=${reviewCommentDTO != null}"></textarea>
          
                    <textarea 
                    th:if="${reviewCommentDTO == null}"
                    class="revComment bg-[#e2ecf9] h-[188px] flex-1 relative tracking-[0.15px] leading-[24px] inline-block max-w-full">
                  </textarea>
                    </div>
                  </div>
                  <div
                    class="h-[2px] !m-[0] absolute top-[0px] left-[12px] bg-[#fff] flex flex-row items-center justify-start py-[0px] px-[3px] box-border z-[1]"
                  >
                    <div
                      class="relative tracking-[0.15px] leading-[12px] inline-block min-w-[25px]"
                    >
                      내용
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section
          class="self-stretch flex flex-row items-start justify-center flex-wrap content-start pt-[15px] px-[520px] pb-[43px] gap-[30px] lg:pl-[260px] lg:pr-[260px] lg:box-border mq750:gap-[15px] mq750:pl-[130px] mq750:pr-[130px] mq750:box-border mq450:pl-[20px] mq450:pr-[20px] mq450:box-border"
        >
          <button type="button" onclick="regRevComment()"
            class="cursor-pointer border-[#2196f3] border-[1px] border-solid py-[6px] px-[33px] bg-[#fff] rounded-[4px] box-border overflow-hidden flex flex-col items-center justify-center min-w-[75px]"
          >
            <div
              class="w-[32px] flex flex-row items-center justify-center gap-[8px]"
            >
              <div
                class="relative text-[15px] tracking-[0.46px] leading-[26px] uppercase font-medium font-[Roboto] text-[#2196f3] text-left inline-block min-w-[31px]"
              >
                등록
              </div>
            </div>
          </button>
          <button type="button" onclick="updateRevComment()"
            class="cursor-pointer [border:none] py-[8px] px-[34px] bg-[#2196f3] rounded-[4px] overflow-hidden flex flex-col items-center justify-center"
          >
            <div
              class="w-[32px] flex flex-row items-center justify-center gap-[8px]"
            >

              <b
                class="relative text-[15px] tracking-[0.46px] leading-[26px] uppercase inline-block font-[Roboto] text-[#fff] text-left min-w-[31px]"
                >수정</b
              >
            </div>
          </button>
          <button type="button" onclick="delRevComment()"
            class="cursor-pointer border-[#2196f3] border-[1px] border-solid py-[6px] px-[33px] bg-[#fff] rounded-[4px] box-border overflow-hidden flex flex-col items-center justify-center min-w-[75px]"
          >
            <div
              class="w-[32px] flex flex-row items-center justify-center gap-[8px]"
            >

              <b
                class="relative text-[15px] tracking-[0.46px] leading-[26px] uppercase font-medium font-[Roboto] text-[#2196f3] text-left inline-block min-w-[31px]"
                >삭제</b
              >
            </div>
          </button>
        </section>
      </main>
      <input type="hidden" id="revIdx" th:value="${review.id}" />
    </div>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/htmx.org@1.6.1"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      function regRevComment() {
        var rcComment = $('.revComment').val();
        var revIdx = $('#revIdx').val();

        if (rcComment == '') {
          alert('내용을 입력해주세요.');
          return;
        }
        $.ajax({
          url: '/host/regRevComment',
          type: 'POST',
          data: {
            revIdx: revIdx,
            rcComment: rcComment
          },
          success: function(data) {
            if (data == 'success') {
              alert('등록되었습니다.');
              location.href = '/host/review';
            } else {
              alert('등록에 실패했습니다.');
            }
          }
        });
      }

      function delRevComment() {
        var revIdx = $('#revIdx').val();
        
        $.ajax({
          url: '/host/delRevComment',
          type: 'POST',
          data: {
            revIdx: revIdx,
          },
          success: function(data) {
            if (data == 'success') {
              alert('삭제되었습니다.');
              location.href = '/host/review';
            } else {
              alert('삭제 실패했습니다.');
            }
          }
        });
      }

      function updateRevComment() {
        $('.revComment').removeAttr('readonly');
      }
    </script>
  </body>
</html>
